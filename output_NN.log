nohup: 入力を無視します
2025-09-19 08:48:04.259730: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:31] Could not find cuda drivers on your machine, GPU will not be used.
2025-09-19 08:48:04.310085: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-09-19 08:48:05.910450: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:31] Could not find cuda drivers on your machine, GPU will not be used.
      d__Archaea;p__Aenigmarchaeota;c__Aenigmarchaeia;o__Aenigmarchaeales;f__Aenigmarchaeales;g__Aenigmarchaeales  ...  d__Eukaryota;p__Zoopagomycota;c__Incertae_Sedis;o__Kickxellales;f__Kickxellaceae;g__Spiromyces
0                                          6.062568e-16                                                            ...                                         -15.059084                                             
1                                         -5.764302e-16                                                            ...                                         -14.219160                                             
2                                         -2.289340e-16                                                            ...                                         -16.880591                                             
3                                         -3.333994e-16                                                            ...                                         -13.378841                                             
4                                         -2.670371e-16                                                            ...                                         -19.951495                                             
...                                                 ...                                                            ...                                                ...                                             
2528                                      -1.002237e-15                                                            ...                                         -24.967522                                             
2529                                       5.778600e-16                                                            ...                                         -14.915955                                             
2530                                       9.118953e-16                                                            ...                                         -30.976300                                             
2531                                      -2.984998e-16                                                            ...                                         -22.024191                                             
2532                                       7.449487e-16                                                            ...                                         -23.285132                                             

[2463 rows x 1597 columns]
特徴選択前：(1576, 1597)
特徴選択後：(1576, 1597)
torch.Size([1576, 1597])
学習データ数: 1576
検証データ数: 394
テストデータ数: 493
Epoch [1/30], Train Loss: 0.9502, Validation Loss: 1.0085
Epoch [2/30], Train Loss: 0.7807, Validation Loss: 0.8691
Epoch [3/30], Train Loss: 0.6629, Validation Loss: 0.7685
Epoch [4/30], Train Loss: 0.5762, Validation Loss: 0.6999
Epoch [5/30], Train Loss: 0.4916, Validation Loss: 0.6548
Epoch [6/30], Train Loss: 0.4266, Validation Loss: 0.6011
Epoch [7/30], Train Loss: 0.3678, Validation Loss: 0.5847
Epoch [8/30], Train Loss: 0.3339, Validation Loss: 0.5586
Epoch [9/30], Train Loss: 0.2733, Validation Loss: 0.5417
Epoch [10/30], Train Loss: 0.2252, Validation Loss: 0.5445
Epoch [11/30], Train Loss: 0.1925, Validation Loss: 0.5494
Epoch [12/30], Train Loss: 0.1754, Validation Loss: 0.5463
Epoch [13/30], Train Loss: 0.1309, Validation Loss: 0.6002
Epoch [14/30], Train Loss: 0.1021, Validation Loss: 0.5729
Epoch [15/30], Train Loss: 0.0858, Validation Loss: 0.5718
Epoch [16/30], Train Loss: 0.0723, Validation Loss: 0.5802
Epoch [17/30], Train Loss: 0.0559, Validation Loss: 0.5835
Epoch [18/30], Train Loss: 0.0407, Validation Loss: 0.6221
Epoch [19/30], Train Loss: 0.0349, Validation Loss: 0.6214
Epoch [20/30], Train Loss: 0.0309, Validation Loss: 0.6042
Epoch [21/30], Train Loss: 0.0257, Validation Loss: 0.6307
Epoch [22/30], Train Loss: 0.0242, Validation Loss: 0.6168
Epoch [23/30], Train Loss: 0.0234, Validation Loss: 0.6125
Epoch [24/30], Train Loss: 0.0197, Validation Loss: 0.6187
Epoch [25/30], Train Loss: 0.0189, Validation Loss: 0.6548
Epoch [26/30], Train Loss: 0.0131, Validation Loss: 0.7081
Epoch [27/30], Train Loss: 0.0208, Validation Loss: 0.6264
Epoch [28/30], Train Loss: 0.0130, Validation Loss: 0.6847
Epoch [29/30], Train Loss: 0.0123, Validation Loss: 0.6633
Epoch [30/30], Train Loss: 0.0186, Validation Loss: 0.6943
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil']/fold1/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil']/fold1/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil']/fold1/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil']/fold1/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.621, MSE = 0.394
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.066064 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1576, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(493, 1)
(493, 1597)
fold1
RF：
決定係数：0.6647467957744992
MAE：0.35592340228820546
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold1/RF/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold1/RF/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold1/RF/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
XGB：
決定係数：0.6244975880190397
MAE：0.3701545000076294
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold1/XGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold1/XGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold1/XGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
LGB：
決定係数：0.6545899232601358
MAE：0.3625643989480624
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold1/LGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold1/LGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold1/LGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1576, 1597)
特徴選択後：(1576, 1597)
torch.Size([1576, 1597])
学習データ数: 1576
検証データ数: 394
テストデータ数: 493
Epoch [1/30], Train Loss: 0.9646, Validation Loss: 1.1560
Epoch [2/30], Train Loss: 0.8129, Validation Loss: 0.9973
Epoch [3/30], Train Loss: 0.6832, Validation Loss: 0.8673
Epoch [4/30], Train Loss: 0.5879, Validation Loss: 0.7801
Epoch [5/30], Train Loss: 0.5141, Validation Loss: 0.6877
Epoch [6/30], Train Loss: 0.4374, Validation Loss: 0.6294
Epoch [7/30], Train Loss: 0.3835, Validation Loss: 0.5999
Epoch [8/30], Train Loss: 0.3359, Validation Loss: 0.5677
Epoch [9/30], Train Loss: 0.2961, Validation Loss: 0.5978
Epoch [10/30], Train Loss: 0.2448, Validation Loss: 0.5769
Epoch [11/30], Train Loss: 0.1991, Validation Loss: 0.5868
Epoch [12/30], Train Loss: 0.1633, Validation Loss: 0.5854
Epoch [13/30], Train Loss: 0.1347, Validation Loss: 0.5924
Epoch [14/30], Train Loss: 0.1070, Validation Loss: 0.6212
Epoch [15/30], Train Loss: 0.0811, Validation Loss: 0.6156
Epoch [16/30], Train Loss: 0.0617, Validation Loss: 0.5906
Epoch [17/30], Train Loss: 0.0503, Validation Loss: 0.6193
Epoch [18/30], Train Loss: 0.0482, Validation Loss: 0.6115
Epoch [19/30], Train Loss: 0.0380, Validation Loss: 0.6344
Epoch [20/30], Train Loss: 0.0329, Validation Loss: 0.6009
Epoch [21/30], Train Loss: 0.0337, Validation Loss: 0.6355
Epoch [22/30], Train Loss: 0.0196, Validation Loss: 0.6381
Epoch [23/30], Train Loss: 0.0269, Validation Loss: 0.6053
Epoch [24/30], Train Loss: 0.0187, Validation Loss: 0.6421
Epoch [25/30], Train Loss: 0.0203, Validation Loss: 0.6345
Epoch [26/30], Train Loss: 0.0165, Validation Loss: 0.6192
Epoch [27/30], Train Loss: 0.0157, Validation Loss: 0.6375
Epoch [28/30], Train Loss: 0.0145, Validation Loss: 0.6130
Epoch [29/30], Train Loss: 0.0141, Validation Loss: 0.6243
Epoch [30/30], Train Loss: 0.0114, Validation Loss: 0.6367
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil']/fold2/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil']/fold2/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil']/fold2/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil']/fold2/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.643, MSE = 0.369
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.086233 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1576, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(493, 1)
(493, 1597)
fold2
RF：
決定係数：0.6731500879782004
MAE：0.34561596207905126
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold2/RF/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold2/RF/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold2/RF/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
XGB：
決定係数：0.6506505714222263
MAE：0.35574933886528015
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold2/XGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold2/XGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold2/XGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
LGB：
決定係数：0.6797480311348063
MAE：0.3419038705048523
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold2/LGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold2/LGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold2/LGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1576, 1597)
特徴選択後：(1576, 1597)
torch.Size([1576, 1597])
学習データ数: 1576
検証データ数: 394
テストデータ数: 493
Epoch [1/30], Train Loss: 0.9138, Validation Loss: 0.8523
Epoch [2/30], Train Loss: 0.7504, Validation Loss: 0.7400
Epoch [3/30], Train Loss: 0.6409, Validation Loss: 0.6465
Epoch [4/30], Train Loss: 0.5269, Validation Loss: 0.5664
Epoch [5/30], Train Loss: 0.4488, Validation Loss: 0.4900
Epoch [6/30], Train Loss: 0.3854, Validation Loss: 0.4558
Epoch [7/30], Train Loss: 0.3361, Validation Loss: 0.4418
Epoch [8/30], Train Loss: 0.2939, Validation Loss: 0.4432
Epoch [9/30], Train Loss: 0.2407, Validation Loss: 0.4313
Epoch [10/30], Train Loss: 0.2031, Validation Loss: 0.4385
Epoch [11/30], Train Loss: 0.1724, Validation Loss: 0.4434
Epoch [12/30], Train Loss: 0.1422, Validation Loss: 0.4568
Epoch [13/30], Train Loss: 0.1063, Validation Loss: 0.4602
Epoch [14/30], Train Loss: 0.0962, Validation Loss: 0.4888
Epoch [15/30], Train Loss: 0.0708, Validation Loss: 0.4939
Epoch [16/30], Train Loss: 0.0535, Validation Loss: 0.5049
Epoch [17/30], Train Loss: 0.0463, Validation Loss: 0.4940
Epoch [18/30], Train Loss: 0.0307, Validation Loss: 0.4955
Epoch [19/30], Train Loss: 0.0287, Validation Loss: 0.4964
Epoch [20/30], Train Loss: 0.0223, Validation Loss: 0.5002
Epoch [21/30], Train Loss: 0.0207, Validation Loss: 0.5016
Epoch [22/30], Train Loss: 0.0143, Validation Loss: 0.5108
Epoch [23/30], Train Loss: 0.0139, Validation Loss: 0.5182
Epoch [24/30], Train Loss: 0.0187, Validation Loss: 0.5231
Epoch [25/30], Train Loss: 0.0151, Validation Loss: 0.5130
Epoch [26/30], Train Loss: 0.0095, Validation Loss: 0.5052
Epoch [27/30], Train Loss: 0.0113, Validation Loss: 0.5071
Epoch [28/30], Train Loss: 0.0122, Validation Loss: 0.5057
Epoch [29/30], Train Loss: 0.0080, Validation Loss: 0.5112
Epoch [30/30], Train Loss: 0.0150, Validation Loss: 0.5102
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil']/fold3/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil']/fold3/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil']/fold3/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil']/fold3/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.648, MSE = 0.381
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.087607 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1576, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(493, 1)
(493, 1597)
fold3
RF：
決定係数：0.6740825387141285
MAE：0.36272932969075616
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold3/RF/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold3/RF/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold3/RF/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
XGB：
決定係数：0.647643844396768
MAE：0.3813773989677429
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold3/XGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold3/XGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold3/XGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
LGB：
決定係数：0.661936911988542
MAE：0.370341696335777
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold3/LGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold3/LGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold3/LGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1576, 1597)
特徴選択後：(1576, 1597)
torch.Size([1576, 1597])
学習データ数: 1576
検証データ数: 395
テストデータ数: 492
Epoch [1/30], Train Loss: 0.9298, Validation Loss: 0.7568
Epoch [2/30], Train Loss: 0.8006, Validation Loss: 0.6669
Epoch [3/30], Train Loss: 0.6923, Validation Loss: 0.5950
Epoch [4/30], Train Loss: 0.5685, Validation Loss: 0.5359
Epoch [5/30], Train Loss: 0.5047, Validation Loss: 0.4935
Epoch [6/30], Train Loss: 0.4257, Validation Loss: 0.4630
Epoch [7/30], Train Loss: 0.3703, Validation Loss: 0.4440
Epoch [8/30], Train Loss: 0.3366, Validation Loss: 0.4312
Epoch [9/30], Train Loss: 0.2835, Validation Loss: 0.4289
Epoch [10/30], Train Loss: 0.2372, Validation Loss: 0.4265
Epoch [11/30], Train Loss: 0.2070, Validation Loss: 0.4235
Epoch [12/30], Train Loss: 0.1754, Validation Loss: 0.4349
Epoch [13/30], Train Loss: 0.1422, Validation Loss: 0.4333
Epoch [14/30], Train Loss: 0.1201, Validation Loss: 0.5018
Epoch [15/30], Train Loss: 0.1004, Validation Loss: 0.4539
Epoch [16/30], Train Loss: 0.0701, Validation Loss: 0.4525
Epoch [17/30], Train Loss: 0.0565, Validation Loss: 0.4763
Epoch [18/30], Train Loss: 0.0488, Validation Loss: 0.4607
Epoch [19/30], Train Loss: 0.0401, Validation Loss: 0.4758
Epoch [20/30], Train Loss: 0.0298, Validation Loss: 0.4782
Epoch [21/30], Train Loss: 0.0295, Validation Loss: 0.4781
Epoch [22/30], Train Loss: 0.0193, Validation Loss: 0.4815
Epoch [23/30], Train Loss: 0.0243, Validation Loss: 0.4752
Epoch [24/30], Train Loss: 0.0308, Validation Loss: 0.4897
Epoch [25/30], Train Loss: 0.0261, Validation Loss: 0.5305
Epoch [26/30], Train Loss: 0.0190, Validation Loss: 0.5233
Epoch [27/30], Train Loss: 0.0183, Validation Loss: 0.4821
Epoch [28/30], Train Loss: 0.0175, Validation Loss: 0.4948
Epoch [29/30], Train Loss: 0.0149, Validation Loss: 0.4880
Epoch [30/30], Train Loss: 0.0134, Validation Loss: 0.4859
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil']/fold4/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil']/fold4/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil']/fold4/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil']/fold4/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.640, MSE = 0.368
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.066762 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1576, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(492, 1)
(492, 1597)
fold4
RF：
決定係数：0.6771745208432721
MAE：0.3518431897069719
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold4/RF/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold4/RF/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold4/RF/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
XGB：
決定係数：0.6339857507468928
MAE：0.37381112575531006
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold4/XGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold4/XGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold4/XGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
LGB：
決定係数：0.6559647772358015
MAE：0.36233026665188905
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold4/LGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold4/LGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold4/LGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1576, 1597)
特徴選択後：(1576, 1597)
torch.Size([1576, 1597])
学習データ数: 1576
検証データ数: 395
テストデータ数: 492
Epoch [1/30], Train Loss: 0.9737, Validation Loss: 0.9051
Epoch [2/30], Train Loss: 0.8160, Validation Loss: 0.8206
Epoch [3/30], Train Loss: 0.7253, Validation Loss: 0.7437
Epoch [4/30], Train Loss: 0.6116, Validation Loss: 0.6860
Epoch [5/30], Train Loss: 0.5243, Validation Loss: 0.6311
Epoch [6/30], Train Loss: 0.4664, Validation Loss: 0.5976
Epoch [7/30], Train Loss: 0.4063, Validation Loss: 0.5749
Epoch [8/30], Train Loss: 0.3622, Validation Loss: 0.5643
Epoch [9/30], Train Loss: 0.2988, Validation Loss: 0.5572
Epoch [10/30], Train Loss: 0.2664, Validation Loss: 0.5595
Epoch [11/30], Train Loss: 0.2203, Validation Loss: 0.5758
Epoch [12/30], Train Loss: 0.1928, Validation Loss: 0.5803
Epoch [13/30], Train Loss: 0.1555, Validation Loss: 0.6019
Epoch [14/30], Train Loss: 0.1337, Validation Loss: 0.6059
Epoch [15/30], Train Loss: 0.1041, Validation Loss: 0.6217
Epoch [16/30], Train Loss: 0.0813, Validation Loss: 0.6341
Epoch [17/30], Train Loss: 0.0667, Validation Loss: 0.6386
Epoch [18/30], Train Loss: 0.0523, Validation Loss: 0.6599
Epoch [19/30], Train Loss: 0.0447, Validation Loss: 0.6533
Epoch [20/30], Train Loss: 0.0310, Validation Loss: 0.6742
Epoch [21/30], Train Loss: 0.0286, Validation Loss: 0.6764
Epoch [22/30], Train Loss: 0.0217, Validation Loss: 0.6652
Epoch [23/30], Train Loss: 0.0235, Validation Loss: 0.6717
Epoch [24/30], Train Loss: 0.0156, Validation Loss: 0.6729
Epoch [25/30], Train Loss: 0.0201, Validation Loss: 0.6853
Epoch [26/30], Train Loss: 0.0168, Validation Loss: 0.6753
Epoch [27/30], Train Loss: 0.0145, Validation Loss: 0.6999
Epoch [28/30], Train Loss: 0.0118, Validation Loss: 0.6801
Epoch [29/30], Train Loss: 0.0090, Validation Loss: 0.6843
Epoch [30/30], Train Loss: 0.0202, Validation Loss: 0.6933
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil']/fold5/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil']/fold5/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil']/fold5/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil']/fold5/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.643, MSE = 0.380
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.064320 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1576, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(492, 1)
(492, 1597)
fold5
RF：
決定係数：0.70583176775861
MAE：0.34706489330399354
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold5/RF/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold5/RF/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold5/RF/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
XGB：
決定係数：0.6802200983903275
MAE：0.3603162169456482
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold5/XGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold5/XGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold5/XGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
LGB：
決定係数：0.7047741765101875
MAE：0.3509998849980832
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil']/fold5/LGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil']/fold5/LGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil']/fold5/LGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
{'MAE': {'LGB': {'pH_dry_soil': '0.358±0.010'},
         'RF': {'pH_dry_soil': '0.353±0.006'},
         'ST': {'pH_dry_soil': '0.378±0.010'},
         'XGB': {'pH_dry_soil': '0.368±0.009'}},
 'R': {'LGB': {'pH_dry_soil': '0.671±0.019'},
       'RF': {'pH_dry_soil': '0.679±0.014'},
       'ST': {'pH_dry_soil': '0.639±0.009'},
       'XGB': {'pH_dry_soil': '0.647±0.019'}}}
CSVファイル 'result.csv' を作成しました。
      d__Archaea;p__Aenigmarchaeota;c__Aenigmarchaeia;o__Aenigmarchaeales;f__Aenigmarchaeales;g__Aenigmarchaeales  ...  d__Eukaryota;p__Zoopagomycota;c__Incertae_Sedis;o__Kickxellales;f__Kickxellaceae;g__Spiromyces
0                                          6.062568e-16                                                            ...                                         -15.059084                                             
1                                         -5.764302e-16                                                            ...                                         -14.219160                                             
2                                         -2.289340e-16                                                            ...                                         -16.880591                                             
3                                         -3.333994e-16                                                            ...                                         -13.378841                                             
4                                         -2.670371e-16                                                            ...                                         -19.951495                                             
...                                                 ...                                                            ...                                                ...                                             
2528                                      -1.002237e-15                                                            ...                                         -24.967522                                             
2529                                       5.778600e-16                                                            ...                                         -14.915955                                             
2530                                       9.118953e-16                                                            ...                                         -30.976300                                             
2531                                      -2.984998e-16                                                            ...                                         -22.024191                                             
2532                                       7.449487e-16                                                            ...                                         -23.285132                                             

[2008 rows x 1597 columns]
特徴選択前：(1284, 1597)
特徴選択後：(1284, 1597)
torch.Size([1284, 1597])
学習データ数: 1284
検証データ数: 322
テストデータ数: 402
Epoch [1/30], Train Loss: 1.0232, Validation Loss: 0.8039
Epoch [2/30], Train Loss: 0.7588, Validation Loss: 0.6961
Epoch [3/30], Train Loss: 0.8780, Validation Loss: 0.6122
Epoch [4/30], Train Loss: 0.5671, Validation Loss: 0.5603
Epoch [5/30], Train Loss: 0.5759, Validation Loss: 0.4990
Epoch [6/30], Train Loss: 0.4247, Validation Loss: 0.4494
Epoch [7/30], Train Loss: 0.8763, Validation Loss: 0.4516
Epoch [8/30], Train Loss: 0.3133, Validation Loss: 0.3859
Epoch [9/30], Train Loss: 0.2873, Validation Loss: 0.3826
Epoch [10/30], Train Loss: 0.3963, Validation Loss: 0.3778
Epoch [11/30], Train Loss: 0.2405, Validation Loss: 0.3378
Epoch [12/30], Train Loss: 0.1966, Validation Loss: 0.3295
Epoch [13/30], Train Loss: 0.2243, Validation Loss: 0.3338
Epoch [14/30], Train Loss: 0.1828, Validation Loss: 0.3461
Epoch [15/30], Train Loss: 0.1474, Validation Loss: 0.3279
Epoch [16/30], Train Loss: 0.1464, Validation Loss: 0.3305
Epoch [17/30], Train Loss: 0.1144, Validation Loss: 0.3443
Epoch [18/30], Train Loss: 0.1847, Validation Loss: 0.3422
Epoch [19/30], Train Loss: 0.1311, Validation Loss: 0.3477
Epoch [20/30], Train Loss: 0.0944, Validation Loss: 0.3479
Epoch [21/30], Train Loss: 0.1556, Validation Loss: 0.3489
Epoch [22/30], Train Loss: 0.0956, Validation Loss: 0.3630
Epoch [23/30], Train Loss: 0.0996, Validation Loss: 0.3579
Epoch [24/30], Train Loss: 0.0981, Validation Loss: 0.3491
Epoch [25/30], Train Loss: 0.1447, Validation Loss: 0.3724
Epoch [26/30], Train Loss: 0.1798, Validation Loss: 0.3467
Epoch [27/30], Train Loss: 0.1129, Validation Loss: 0.3436
Epoch [28/30], Train Loss: 0.0750, Validation Loss: 0.3676
Epoch [29/30], Train Loss: 0.0449, Validation Loss: 0.3437
Epoch [30/30], Train Loss: 0.0457, Validation Loss: 0.3741
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['available_P']/fold1/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['available_P']/fold1/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['available_P']/fold1/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['available_P']/fold1/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (available_P): R^2 Score = 0.759, MSE = 334.626
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.059542 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1284, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(402, 1)
(402, 1597)
fold1
RF：
決定係数：0.6544890663742626
MAE：388.73321476915845
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold1/RF/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold1/RF/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold1/RF/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
XGB：
決定係数：0.6844995157225758
MAE：354.30450439453125
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold1/XGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold1/XGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold1/XGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
LGB：
決定係数：0.7335947292815096
MAE：348.93367267962225
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold1/LGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold1/LGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold1/LGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1284, 1597)
特徴選択後：(1284, 1597)
torch.Size([1284, 1597])
学習データ数: 1284
検証データ数: 322
テストデータ数: 402
Epoch [1/30], Train Loss: 1.2748, Validation Loss: 0.8562
Epoch [2/30], Train Loss: 0.8000, Validation Loss: 0.7757
Epoch [3/30], Train Loss: 0.7308, Validation Loss: 0.7041
Epoch [4/30], Train Loss: 0.6396, Validation Loss: 0.6356
Epoch [5/30], Train Loss: 0.5354, Validation Loss: 0.5703
Epoch [6/30], Train Loss: 0.4493, Validation Loss: 0.5137
Epoch [7/30], Train Loss: 0.4337, Validation Loss: 0.4444
Epoch [8/30], Train Loss: 0.3044, Validation Loss: 0.3848
Epoch [9/30], Train Loss: 0.2596, Validation Loss: 0.3724
Epoch [10/30], Train Loss: 0.1967, Validation Loss: 0.3545
Epoch [11/30], Train Loss: 0.1730, Validation Loss: 0.3409
Epoch [12/30], Train Loss: 0.1447, Validation Loss: 0.3440
Epoch [13/30], Train Loss: 0.1435, Validation Loss: 0.3413
Epoch [14/30], Train Loss: 0.1126, Validation Loss: 0.3345
Epoch [15/30], Train Loss: 0.0937, Validation Loss: 0.3367
Epoch [16/30], Train Loss: 0.0828, Validation Loss: 0.3414
Epoch [17/30], Train Loss: 0.2171, Validation Loss: 0.3448
Epoch [18/30], Train Loss: 0.0719, Validation Loss: 0.3454
Epoch [19/30], Train Loss: 0.0719, Validation Loss: 0.3415
Epoch [20/30], Train Loss: 0.0531, Validation Loss: 0.3410
Epoch [21/30], Train Loss: 0.0482, Validation Loss: 0.3481
Epoch [22/30], Train Loss: 0.0504, Validation Loss: 0.3487
Epoch [23/30], Train Loss: 0.0349, Validation Loss: 0.3397
Epoch [24/30], Train Loss: 0.0336, Validation Loss: 0.3489
Epoch [25/30], Train Loss: 0.0298, Validation Loss: 0.3493
Epoch [26/30], Train Loss: 0.0259, Validation Loss: 0.3446
Epoch [27/30], Train Loss: 0.0369, Validation Loss: 0.3480
Epoch [28/30], Train Loss: 0.0356, Validation Loss: 0.3537
Epoch [29/30], Train Loss: 0.0325, Validation Loss: 0.3468
Epoch [30/30], Train Loss: 0.0181, Validation Loss: 0.3453
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['available_P']/fold2/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['available_P']/fold2/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['available_P']/fold2/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['available_P']/fold2/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (available_P): R^2 Score = 0.756, MSE = 406.244
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.040531 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1284, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(402, 1)
(402, 1597)
fold2
RF：
決定係数：0.7267183697798744
MAE：458.1148585580964
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold2/RF/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold2/RF/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold2/RF/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
XGB：
決定係数：0.723042161760828
MAE：429.03973388671875
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold2/XGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold2/XGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold2/XGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
LGB：
決定係数：0.7503712565115952
MAE：420.27933903281235
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold2/LGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold2/LGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold2/LGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1284, 1597)
特徴選択後：(1284, 1597)
torch.Size([1284, 1597])
学習データ数: 1284
検証データ数: 322
テストデータ数: 402
Epoch [1/30], Train Loss: 1.1410, Validation Loss: 0.7878
Epoch [2/30], Train Loss: 0.8466, Validation Loss: 0.7214
Epoch [3/30], Train Loss: 1.1433, Validation Loss: 0.6539
Epoch [4/30], Train Loss: 1.1631, Validation Loss: 0.5908
Epoch [5/30], Train Loss: 0.7938, Validation Loss: 0.5491
Epoch [6/30], Train Loss: 0.5895, Validation Loss: 0.4938
Epoch [7/30], Train Loss: 0.6461, Validation Loss: 0.4395
Epoch [8/30], Train Loss: 0.5835, Validation Loss: 0.3915
Epoch [9/30], Train Loss: 0.3578, Validation Loss: 0.3569
Epoch [10/30], Train Loss: 0.3476, Validation Loss: 0.3368
Epoch [11/30], Train Loss: 0.2685, Validation Loss: 0.3215
Epoch [12/30], Train Loss: 0.2222, Validation Loss: 0.3106
Epoch [13/30], Train Loss: 0.2305, Validation Loss: 0.2926
Epoch [14/30], Train Loss: 0.1899, Validation Loss: 0.2742
Epoch [15/30], Train Loss: 0.1837, Validation Loss: 0.2937
Epoch [16/30], Train Loss: 0.1971, Validation Loss: 0.3071
Epoch [17/30], Train Loss: 0.1481, Validation Loss: 0.2640
Epoch [18/30], Train Loss: 0.1308, Validation Loss: 0.2830
Epoch [19/30], Train Loss: 0.1097, Validation Loss: 0.2820
Epoch [20/30], Train Loss: 0.0917, Validation Loss: 0.2596
Epoch [21/30], Train Loss: 0.0846, Validation Loss: 0.2707
Epoch [22/30], Train Loss: 0.3461, Validation Loss: 0.2574
Epoch [23/30], Train Loss: 0.0879, Validation Loss: 0.2722
Epoch [24/30], Train Loss: 0.0699, Validation Loss: 0.2797
Epoch [25/30], Train Loss: 0.1161, Validation Loss: 0.2654
Epoch [26/30], Train Loss: 0.0983, Validation Loss: 0.2711
Epoch [27/30], Train Loss: 0.0816, Validation Loss: 0.2712
Epoch [28/30], Train Loss: 0.0908, Validation Loss: 0.2707
Epoch [29/30], Train Loss: 0.0649, Validation Loss: 0.2784
Epoch [30/30], Train Loss: 0.0414, Validation Loss: 0.2861
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['available_P']/fold3/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['available_P']/fold3/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['available_P']/fold3/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['available_P']/fold3/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (available_P): R^2 Score = 0.765, MSE = 400.515
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.089864 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1284, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(402, 1)
(402, 1597)
fold3
RF：
決定係数：0.7705466409039855
MAE：404.62484920019153
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold3/RF/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold3/RF/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold3/RF/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
XGB：
決定係数：0.7398146283979892
MAE：399.2093811035156
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold3/XGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold3/XGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold3/XGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
LGB：
決定係数：0.7703899805468427
MAE：400.3182834270219
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold3/LGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold3/LGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold3/LGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1285, 1597)
特徴選択後：(1285, 1597)
torch.Size([1285, 1597])
学習データ数: 1285
検証データ数: 322
テストデータ数: 401
Epoch [1/30], Train Loss: 0.8673, Validation Loss: 0.8816
Epoch [2/30], Train Loss: 0.7734, Validation Loss: 0.7265
Epoch [3/30], Train Loss: 0.6985, Validation Loss: 0.6174
Epoch [4/30], Train Loss: 0.5251, Validation Loss: 0.5838
Epoch [5/30], Train Loss: 0.4478, Validation Loss: 0.5175
Epoch [6/30], Train Loss: 0.3722, Validation Loss: 0.4366
Epoch [7/30], Train Loss: 0.4241, Validation Loss: 0.4345
Epoch [8/30], Train Loss: 0.2611, Validation Loss: 0.4059
Epoch [9/30], Train Loss: 0.3152, Validation Loss: 0.3840
Epoch [10/30], Train Loss: 0.2003, Validation Loss: 0.3512
Epoch [11/30], Train Loss: 0.1840, Validation Loss: 0.3520
Epoch [12/30], Train Loss: 0.1917, Validation Loss: 0.3376
Epoch [13/30], Train Loss: 0.1477, Validation Loss: 0.3391
Epoch [14/30], Train Loss: 0.2066, Validation Loss: 0.3599
Epoch [15/30], Train Loss: 0.1187, Validation Loss: 0.3452
Epoch [16/30], Train Loss: 0.1162, Validation Loss: 0.3408
Epoch [17/30], Train Loss: 0.1068, Validation Loss: 0.3372
Epoch [18/30], Train Loss: 0.0941, Validation Loss: 0.3500
Epoch [19/30], Train Loss: 0.0875, Validation Loss: 0.3409
Epoch [20/30], Train Loss: 0.0741, Validation Loss: 0.3415
Epoch [21/30], Train Loss: 0.0792, Validation Loss: 0.3761
Epoch [22/30], Train Loss: 0.0893, Validation Loss: 0.3499
Epoch [23/30], Train Loss: 0.0606, Validation Loss: 0.3532
Epoch [24/30], Train Loss: 0.0615, Validation Loss: 0.3422
Epoch [25/30], Train Loss: 0.0489, Validation Loss: 0.3994
Epoch [26/30], Train Loss: 0.0392, Validation Loss: 0.3703
Epoch [27/30], Train Loss: 0.0466, Validation Loss: 0.3497
Epoch [28/30], Train Loss: 0.0392, Validation Loss: 0.3626
Epoch [29/30], Train Loss: 0.0391, Validation Loss: 0.3589
Epoch [30/30], Train Loss: 0.0359, Validation Loss: 0.3487
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['available_P']/fold4/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['available_P']/fold4/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['available_P']/fold4/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['available_P']/fold4/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (available_P): R^2 Score = 0.800, MSE = 372.146
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.095407 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1285, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(401, 1)
(401, 1597)
fold4
RF：
決定係数：0.6978153745467718
MAE：384.039339119302
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold4/RF/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold4/RF/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold4/RF/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
XGB：
決定係数：0.7095280129463553
MAE：364.36517333984375
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold4/XGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold4/XGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold4/XGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
LGB：
決定係数：0.7333765960778131
MAE：358.74641061627074
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold4/LGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold4/LGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold4/LGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1285, 1597)
特徴選択後：(1285, 1597)
torch.Size([1285, 1597])
学習データ数: 1285
検証データ数: 322
テストデータ数: 401
Epoch [1/30], Train Loss: 0.8808, Validation Loss: 0.8072
Epoch [2/30], Train Loss: 0.7639, Validation Loss: 0.6986
Epoch [3/30], Train Loss: 0.6637, Validation Loss: 0.6062
Epoch [4/30], Train Loss: 0.5873, Validation Loss: 0.5415
Epoch [5/30], Train Loss: 0.5308, Validation Loss: 0.4848
Epoch [6/30], Train Loss: 0.4594, Validation Loss: 0.3897
Epoch [7/30], Train Loss: 0.3206, Validation Loss: 0.3549
Epoch [8/30], Train Loss: 0.2728, Validation Loss: 0.3328
Epoch [9/30], Train Loss: 0.2306, Validation Loss: 0.2952
Epoch [10/30], Train Loss: 0.2058, Validation Loss: 0.2834
Epoch [11/30], Train Loss: 0.1639, Validation Loss: 0.2948
Epoch [12/30], Train Loss: 0.1459, Validation Loss: 0.2871
Epoch [13/30], Train Loss: 0.1388, Validation Loss: 0.2797
Epoch [14/30], Train Loss: 0.1409, Validation Loss: 0.2855
Epoch [15/30], Train Loss: 0.1102, Validation Loss: 0.2903
Epoch [16/30], Train Loss: 0.1025, Validation Loss: 0.2840
Epoch [17/30], Train Loss: 0.1700, Validation Loss: 0.2888
Epoch [18/30], Train Loss: 0.0935, Validation Loss: 0.3158
Epoch [19/30], Train Loss: 0.0684, Validation Loss: 0.3093
Epoch [20/30], Train Loss: 0.1005, Validation Loss: 0.3210
Epoch [21/30], Train Loss: 0.0555, Validation Loss: 0.3191
Epoch [22/30], Train Loss: 0.0892, Validation Loss: 0.3074
Epoch [23/30], Train Loss: 0.0498, Validation Loss: 0.2965
Epoch [24/30], Train Loss: 0.0683, Validation Loss: 0.3092
Epoch [25/30], Train Loss: 0.0387, Validation Loss: 0.2997
Epoch [26/30], Train Loss: 0.0439, Validation Loss: 0.3135
Epoch [27/30], Train Loss: 0.0368, Validation Loss: 0.2997
Epoch [28/30], Train Loss: 0.0392, Validation Loss: 0.3037
Epoch [29/30], Train Loss: 0.0378, Validation Loss: 0.3094
Epoch [30/30], Train Loss: 0.0395, Validation Loss: 0.3013
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['available_P']/fold5/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['available_P']/fold5/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['available_P']/fold5/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['available_P']/fold5/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (available_P): R^2 Score = 0.802, MSE = 326.626
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.090247 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1285, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(401, 1)
(401, 1597)
fold5
RF：
決定係数：0.7471744432752372
MAE：397.7871736147403
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold5/RF/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold5/RF/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold5/RF/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
XGB：
決定係数：0.7135860744784612
MAE：377.8725891113281
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold5/XGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold5/XGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold5/XGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
LGB：
決定係数：0.7631882848111335
MAE：377.87009703400383
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['available_P']/fold5/LGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['available_P']/fold5/LGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['available_P']/fold5/LGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
{'MAE': {'LGB': {'available_P': '381.230±26.264'},
         'RF': {'available_P': '406.660±26.697'},
         'ST': {'available_P': '368.031±32.750'},
         'XGB': {'available_P': '384.958±26.684'}},
 'R': {'LGB': {'available_P': '0.750±0.015'},
       'RF': {'available_P': '0.719±0.040'},
       'ST': {'available_P': '0.776±0.020'},
       'XGB': {'available_P': '0.714±0.018'}}}
CSVファイル 'result.csv' を作成しました。
      d__Archaea;p__Aenigmarchaeota;c__Aenigmarchaeia;o__Aenigmarchaeales;f__Aenigmarchaeales;g__Aenigmarchaeales  ...  d__Eukaryota;p__Zoopagomycota;c__Incertae_Sedis;o__Kickxellales;f__Kickxellaceae;g__Spiromyces
0                                          6.062568e-16                                                            ...                                         -15.059084                                             
1                                         -5.764302e-16                                                            ...                                         -14.219160                                             
2                                         -2.289340e-16                                                            ...                                         -16.880591                                             
3                                         -3.333994e-16                                                            ...                                         -13.378841                                             
4                                         -2.670371e-16                                                            ...                                         -19.951495                                             
...                                                 ...                                                            ...                                                ...                                             
2528                                      -1.002237e-15                                                            ...                                         -24.967522                                             
2529                                       5.778600e-16                                                            ...                                         -14.915955                                             
2530                                       9.118953e-16                                                            ...                                         -30.976300                                             
2531                                      -2.984998e-16                                                            ...                                         -22.024191                                             
2532                                       7.449487e-16                                                            ...                                         -23.285132                                             

[2304 rows x 1597 columns]
特徴選択前：(1474, 1597)
特徴選択後：(1474, 1597)
torch.Size([1474, 1597])
学習データ数: 1474
検証データ数: 369
テストデータ数: 461
Epoch [1/30], Train Loss: 0.9063, Validation Loss: 0.8184
Epoch [2/30], Train Loss: 0.7624, Validation Loss: 0.7264
Epoch [3/30], Train Loss: 0.5970, Validation Loss: 0.6323
Epoch [4/30], Train Loss: 0.4859, Validation Loss: 0.5668
Epoch [5/30], Train Loss: 0.4263, Validation Loss: 0.5235
Epoch [6/30], Train Loss: 0.3711, Validation Loss: 0.4930
Epoch [7/30], Train Loss: 0.3288, Validation Loss: 0.4708
Epoch [8/30], Train Loss: 0.2936, Validation Loss: 0.4564
Epoch [9/30], Train Loss: 0.2427, Validation Loss: 0.4463
Epoch [10/30], Train Loss: 0.2123, Validation Loss: 0.4393
Epoch [11/30], Train Loss: 0.1923, Validation Loss: 0.4400
Epoch [12/30], Train Loss: 0.1506, Validation Loss: 0.4400
Epoch [13/30], Train Loss: 0.1333, Validation Loss: 0.4439
Epoch [14/30], Train Loss: 0.1071, Validation Loss: 0.4466
Epoch [15/30], Train Loss: 0.0904, Validation Loss: 0.4472
Epoch [16/30], Train Loss: 0.0858, Validation Loss: 0.4475
Epoch [17/30], Train Loss: 0.0658, Validation Loss: 0.4817
Epoch [18/30], Train Loss: 0.0555, Validation Loss: 0.4787
Epoch [19/30], Train Loss: 0.0490, Validation Loss: 0.4759
Epoch [20/30], Train Loss: 0.0410, Validation Loss: 0.4660
Epoch [21/30], Train Loss: 0.0305, Validation Loss: 0.4835
Epoch [22/30], Train Loss: 0.0304, Validation Loss: 0.4943
Epoch [23/30], Train Loss: 0.0214, Validation Loss: 0.4809
Epoch [24/30], Train Loss: 0.0196, Validation Loss: 0.4765
Epoch [25/30], Train Loss: 0.0141, Validation Loss: 0.4886
Epoch [26/30], Train Loss: 0.0191, Validation Loss: 0.4760
Epoch [27/30], Train Loss: 0.0196, Validation Loss: 0.4865
Epoch [28/30], Train Loss: 0.0139, Validation Loss: 0.4843
Epoch [29/30], Train Loss: 0.0111, Validation Loss: 0.4727
Epoch [30/30], Train Loss: 0.0162, Validation Loss: 0.4811
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['EC_electric_conductivity']/fold1/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['EC_electric_conductivity']/fold1/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['EC_electric_conductivity']/fold1/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['EC_electric_conductivity']/fold1/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (EC_electric_conductivity): R^2 Score = 0.727, MSE = 0.143
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.084699 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1474, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(461, 1)
(461, 1597)
fold1
RF：
決定係数：0.7309655933626776
MAE：0.14786496502586588
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold1/RF/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold1/RF/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold1/RF/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
XGB：
決定係数：0.7054078774477835
MAE：0.15203070640563965
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold1/XGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold1/XGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold1/XGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
LGB：
決定係数：0.7397594919696049
MAE：0.13803892674143262
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold1/LGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold1/LGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold1/LGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1474, 1597)
特徴選択後：(1474, 1597)
torch.Size([1474, 1597])
学習データ数: 1474
検証データ数: 369
テストデータ数: 461
Epoch [1/30], Train Loss: 0.9329, Validation Loss: 0.8438
Epoch [2/30], Train Loss: 0.7584, Validation Loss: 0.7369
Epoch [3/30], Train Loss: 0.6248, Validation Loss: 0.6286
Epoch [4/30], Train Loss: 0.4934, Validation Loss: 0.5571
Epoch [5/30], Train Loss: 0.4848, Validation Loss: 0.5065
Epoch [6/30], Train Loss: 0.3869, Validation Loss: 0.4588
Epoch [7/30], Train Loss: 0.3343, Validation Loss: 0.4343
Epoch [8/30], Train Loss: 0.3309, Validation Loss: 0.4018
Epoch [9/30], Train Loss: 0.2409, Validation Loss: 0.3821
Epoch [10/30], Train Loss: 0.2066, Validation Loss: 0.3664
Epoch [11/30], Train Loss: 0.1728, Validation Loss: 0.3536
Epoch [12/30], Train Loss: 0.1419, Validation Loss: 0.3574
Epoch [13/30], Train Loss: 0.1209, Validation Loss: 0.3676
Epoch [14/30], Train Loss: 0.1022, Validation Loss: 0.3602
Epoch [15/30], Train Loss: 0.0818, Validation Loss: 0.3698
Epoch [16/30], Train Loss: 0.0633, Validation Loss: 0.3658
Epoch [17/30], Train Loss: 0.0508, Validation Loss: 0.3843
Epoch [18/30], Train Loss: 0.0449, Validation Loss: 0.3811
Epoch [19/30], Train Loss: 0.0426, Validation Loss: 0.4446
Epoch [20/30], Train Loss: 0.0323, Validation Loss: 0.3865
Epoch [21/30], Train Loss: 0.0217, Validation Loss: 0.3882
Epoch [22/30], Train Loss: 0.0182, Validation Loss: 0.4083
Epoch [23/30], Train Loss: 0.0186, Validation Loss: 0.3918
Epoch [24/30], Train Loss: 0.0249, Validation Loss: 0.4082
Epoch [25/30], Train Loss: 0.0235, Validation Loss: 0.4422
Epoch [26/30], Train Loss: 0.0182, Validation Loss: 0.3921
Epoch [27/30], Train Loss: 0.0157, Validation Loss: 0.3922
Epoch [28/30], Train Loss: 0.0071, Validation Loss: 0.3925
Epoch [29/30], Train Loss: 0.0081, Validation Loss: 0.3935
Epoch [30/30], Train Loss: 0.0077, Validation Loss: 0.3991
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['EC_electric_conductivity']/fold2/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['EC_electric_conductivity']/fold2/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['EC_electric_conductivity']/fold2/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['EC_electric_conductivity']/fold2/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (EC_electric_conductivity): R^2 Score = 0.720, MSE = 0.140
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.071941 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1474, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(461, 1)
(461, 1597)
fold2
RF：
決定係数：0.7185659715680723
MAE：0.128374001857463
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold2/RF/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold2/RF/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold2/RF/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
XGB：
決定係数：0.7086308547386193
MAE：0.1314360797405243
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold2/XGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold2/XGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold2/XGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
LGB：
決定係数：0.7221421050162733
MAE：0.12888233720625095
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold2/LGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold2/LGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold2/LGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1474, 1597)
特徴選択後：(1474, 1597)
torch.Size([1474, 1597])
学習データ数: 1474
検証データ数: 369
テストデータ数: 461
Epoch [1/30], Train Loss: 0.9509, Validation Loss: 0.7226
Epoch [2/30], Train Loss: 0.7752, Validation Loss: 0.5958
Epoch [3/30], Train Loss: 0.5979, Validation Loss: 0.5060
Epoch [4/30], Train Loss: 0.5090, Validation Loss: 0.4792
Epoch [5/30], Train Loss: 0.4348, Validation Loss: 0.4491
Epoch [6/30], Train Loss: 0.3714, Validation Loss: 0.4233
Epoch [7/30], Train Loss: 0.3153, Validation Loss: 0.4069
Epoch [8/30], Train Loss: 0.2729, Validation Loss: 0.4038
Epoch [9/30], Train Loss: 0.2316, Validation Loss: 0.3971
Epoch [10/30], Train Loss: 0.1895, Validation Loss: 0.4026
Epoch [11/30], Train Loss: 0.1793, Validation Loss: 0.4105
Epoch [12/30], Train Loss: 0.1445, Validation Loss: 0.4232
Epoch [13/30], Train Loss: 0.1192, Validation Loss: 0.4228
Epoch [14/30], Train Loss: 0.0958, Validation Loss: 0.4306
Epoch [15/30], Train Loss: 0.0810, Validation Loss: 0.4391
Epoch [16/30], Train Loss: 0.0616, Validation Loss: 0.4823
Epoch [17/30], Train Loss: 0.0516, Validation Loss: 0.4451
Epoch [18/30], Train Loss: 0.0447, Validation Loss: 0.4479
Epoch [19/30], Train Loss: 0.0359, Validation Loss: 0.4646
Epoch [20/30], Train Loss: 0.0318, Validation Loss: 0.4571
Epoch [21/30], Train Loss: 0.0269, Validation Loss: 0.4513
Epoch [22/30], Train Loss: 0.0215, Validation Loss: 0.4530
Epoch [23/30], Train Loss: 0.0174, Validation Loss: 0.4665
Epoch [24/30], Train Loss: 0.0160, Validation Loss: 0.4722
Epoch [25/30], Train Loss: 0.0169, Validation Loss: 0.4569
Epoch [26/30], Train Loss: 0.0161, Validation Loss: 0.4601
Epoch [27/30], Train Loss: 0.0143, Validation Loss: 0.4556
Epoch [28/30], Train Loss: 0.0081, Validation Loss: 0.4644
Epoch [29/30], Train Loss: 0.0183, Validation Loss: 0.4701
Epoch [30/30], Train Loss: 0.0071, Validation Loss: 0.4597
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['EC_electric_conductivity']/fold3/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['EC_electric_conductivity']/fold3/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['EC_electric_conductivity']/fold3/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['EC_electric_conductivity']/fold3/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (EC_electric_conductivity): R^2 Score = 0.762, MSE = 0.137
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.087120 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1474, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(461, 1)
(461, 1597)
fold3
RF：
決定係数：0.7731941443123129
MAE：0.12669785216697418
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold3/RF/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold3/RF/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold3/RF/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
XGB：
決定係数：0.7772717482662068
MAE：0.12604151666164398
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold3/XGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold3/XGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold3/XGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
LGB：
決定係数：0.7723376872020667
MAE：0.12597751391413534
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold3/LGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold3/LGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold3/LGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1474, 1597)
特徴選択後：(1474, 1597)
torch.Size([1474, 1597])
学習データ数: 1474
検証データ数: 369
テストデータ数: 461
Epoch [1/30], Train Loss: 0.9443, Validation Loss: 0.7081
Epoch [2/30], Train Loss: 0.7602, Validation Loss: 0.6310
Epoch [3/30], Train Loss: 0.6210, Validation Loss: 0.5695
Epoch [4/30], Train Loss: 0.4937, Validation Loss: 0.5210
Epoch [5/30], Train Loss: 0.4330, Validation Loss: 0.4855
Epoch [6/30], Train Loss: 0.3654, Validation Loss: 0.4384
Epoch [7/30], Train Loss: 0.3663, Validation Loss: 0.4212
Epoch [8/30], Train Loss: 0.2786, Validation Loss: 0.3831
Epoch [9/30], Train Loss: 0.2517, Validation Loss: 0.3800
Epoch [10/30], Train Loss: 0.2173, Validation Loss: 0.3522
Epoch [11/30], Train Loss: 0.1750, Validation Loss: 0.3406
Epoch [12/30], Train Loss: 0.1535, Validation Loss: 0.3364
Epoch [13/30], Train Loss: 0.1238, Validation Loss: 0.3505
Epoch [14/30], Train Loss: 0.0993, Validation Loss: 0.3347
Epoch [15/30], Train Loss: 0.0831, Validation Loss: 0.3405
Epoch [16/30], Train Loss: 0.0668, Validation Loss: 0.3650
Epoch [17/30], Train Loss: 0.0551, Validation Loss: 0.3442
Epoch [18/30], Train Loss: 0.0532, Validation Loss: 0.3565
Epoch [19/30], Train Loss: 0.0383, Validation Loss: 0.4181
Epoch [20/30], Train Loss: 0.0319, Validation Loss: 0.3605
Epoch [21/30], Train Loss: 0.0266, Validation Loss: 0.3673
Epoch [22/30], Train Loss: 0.0214, Validation Loss: 0.3631
Epoch [23/30], Train Loss: 0.0220, Validation Loss: 0.3705
Epoch [24/30], Train Loss: 0.0164, Validation Loss: 0.3608
Epoch [25/30], Train Loss: 0.0113, Validation Loss: 0.3744
Epoch [26/30], Train Loss: 0.0128, Validation Loss: 0.3581
Epoch [27/30], Train Loss: 0.0098, Validation Loss: 0.3809
Epoch [28/30], Train Loss: 0.0159, Validation Loss: 0.3972
Epoch [29/30], Train Loss: 0.0105, Validation Loss: 0.3977
Epoch [30/30], Train Loss: 0.0104, Validation Loss: 0.3879
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['EC_electric_conductivity']/fold4/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['EC_electric_conductivity']/fold4/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['EC_electric_conductivity']/fold4/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['EC_electric_conductivity']/fold4/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (EC_electric_conductivity): R^2 Score = 0.734, MSE = 0.153
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.091876 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1474, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(461, 1)
(461, 1597)
fold4
RF：
決定係数：0.7697252382392762
MAE：0.12605157707777817
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold4/RF/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold4/RF/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold4/RF/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
XGB：
決定係数：0.7347529766387084
MAE：0.1352941244840622
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold4/XGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold4/XGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold4/XGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
LGB：
決定係数：0.763786738783914
MAE：0.13371708768754711
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold4/LGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold4/LGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold4/LGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1475, 1597)
特徴選択後：(1475, 1597)
torch.Size([1475, 1597])
学習データ数: 1475
検証データ数: 369
テストデータ数: 460
Epoch [1/30], Train Loss: 0.9004, Validation Loss: 0.7029
Epoch [2/30], Train Loss: 0.7198, Validation Loss: 0.5854
Epoch [3/30], Train Loss: 0.5623, Validation Loss: 0.4976
Epoch [4/30], Train Loss: 0.4517, Validation Loss: 0.4466
Epoch [5/30], Train Loss: 0.4030, Validation Loss: 0.4091
Epoch [6/30], Train Loss: 0.3503, Validation Loss: 0.3873
Epoch [7/30], Train Loss: 0.3075, Validation Loss: 0.3695
Epoch [8/30], Train Loss: 0.2817, Validation Loss: 0.3521
Epoch [9/30], Train Loss: 0.2388, Validation Loss: 0.3372
Epoch [10/30], Train Loss: 0.2269, Validation Loss: 0.3268
Epoch [11/30], Train Loss: 0.1767, Validation Loss: 0.3553
Epoch [12/30], Train Loss: 0.1495, Validation Loss: 0.3393
Epoch [13/30], Train Loss: 0.1160, Validation Loss: 0.3772
Epoch [14/30], Train Loss: 0.1061, Validation Loss: 0.3544
Epoch [15/30], Train Loss: 0.0833, Validation Loss: 0.3500
Epoch [16/30], Train Loss: 0.0651, Validation Loss: 0.3649
Epoch [17/30], Train Loss: 0.0584, Validation Loss: 0.4017
Epoch [18/30], Train Loss: 0.0458, Validation Loss: 0.3809
Epoch [19/30], Train Loss: 0.0413, Validation Loss: 0.4262
Epoch [20/30], Train Loss: 0.0347, Validation Loss: 0.3933
Epoch [21/30], Train Loss: 0.0258, Validation Loss: 0.4151
Epoch [22/30], Train Loss: 0.0227, Validation Loss: 0.4110
Epoch [23/30], Train Loss: 0.0191, Validation Loss: 0.4538
Epoch [24/30], Train Loss: 0.0196, Validation Loss: 0.4011
Epoch [25/30], Train Loss: 0.0168, Validation Loss: 0.3827
Epoch [26/30], Train Loss: 0.0120, Validation Loss: 0.3998
Epoch [27/30], Train Loss: 0.0189, Validation Loss: 0.4316
Epoch [28/30], Train Loss: 0.0187, Validation Loss: 0.3884
Epoch [29/30], Train Loss: 0.0141, Validation Loss: 0.3973
Epoch [30/30], Train Loss: 0.0090, Validation Loss: 0.4222
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['EC_electric_conductivity']/fold5/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['EC_electric_conductivity']/fold5/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['EC_electric_conductivity']/fold5/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['EC_electric_conductivity']/fold5/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (EC_electric_conductivity): R^2 Score = 0.738, MSE = 0.146
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.058102 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407235
[LightGBM] [Info] Number of data points in the train set: 1475, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(460, 1)
(460, 1597)
fold5
RF：
決定係数：0.6911068070724182
MAE：0.136311682635979
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold5/RF/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold5/RF/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold5/RF/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
XGB：
決定係数：0.6799151976351747
MAE：0.14236436784267426
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold5/XGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold5/XGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold5/XGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
LGB：
決定係数：0.6877366718723475
MAE：0.14097798481165422
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['EC_electric_conductivity']/fold5/LGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['EC_electric_conductivity']/fold5/LGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['EC_electric_conductivity']/fold5/LGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
{'MAE': {'LGB': {'EC_electric_conductivity': '0.134±0.006'},
         'RF': {'EC_electric_conductivity': '0.133±0.008'},
         'ST': {'EC_electric_conductivity': '0.144±0.005'},
         'XGB': {'EC_electric_conductivity': '0.137±0.009'}},
 'R': {'LGB': {'EC_electric_conductivity': '0.737±0.030'},
       'RF': {'EC_electric_conductivity': '0.737±0.031'},
       'ST': {'EC_electric_conductivity': '0.736±0.014'},
       'XGB': {'EC_electric_conductivity': '0.721±0.033'}}}
CSVファイル 'result.csv' を作成しました。
      d__Archaea;p__Aenigmarchaeota;c__Aenigmarchaeia;o__Aenigmarchaeales;f__Aenigmarchaeales;g__Aenigmarchaeales  ...  d__Eukaryota;p__Zoopagomycota;c__Incertae_Sedis;o__Kickxellales;f__Kickxellaceae;g__Spiromyces
0                                          6.062568e-16                                                            ...                                         -15.059084                                             
1                                         -5.764302e-16                                                            ...                                         -14.219160                                             
2                                         -2.289340e-16                                                            ...                                         -16.880591                                             
3                                         -3.333994e-16                                                            ...                                         -13.378841                                             
4                                         -2.670371e-16                                                            ...                                         -19.951495                                             
...                                                 ...                                                            ...                                                ...                                             
2528                                      -1.002237e-15                                                            ...                                         -24.967522                                             
2529                                       5.778600e-16                                                            ...                                         -14.915955                                             
2530                                       9.118953e-16                                                            ...                                         -30.976300                                             
2531                                      -2.984998e-16                                                            ...                                         -22.024191                                             
2532                                       0.000000e+00                                                            ...                                         -23.285132                                             

[1912 rows x 1597 columns]
特徴選択前：(1223, 1597)
特徴選択後：(1223, 1597)
torch.Size([1223, 1597])
学習データ数: 1223
検証データ数: 306
テストデータ数: 383
Epoch [1/30], Train Loss: 0.9677, Validation Loss: 0.9145
Epoch [2/30], Train Loss: 0.8413, Validation Loss: 0.8486
Epoch [3/30], Train Loss: 0.7490, Validation Loss: 0.7826
Epoch [4/30], Train Loss: 0.6465, Validation Loss: 0.7263
Epoch [5/30], Train Loss: 0.5302, Validation Loss: 0.6797
Epoch [6/30], Train Loss: 0.4314, Validation Loss: 0.6026
Epoch [7/30], Train Loss: 0.3382, Validation Loss: 0.5626
Epoch [8/30], Train Loss: 0.2828, Validation Loss: 0.4938
Epoch [9/30], Train Loss: 0.2224, Validation Loss: 0.4678
Epoch [10/30], Train Loss: 0.1837, Validation Loss: 0.4290
Epoch [11/30], Train Loss: 0.1501, Validation Loss: 0.4308
Epoch [12/30], Train Loss: 0.1145, Validation Loss: 0.4222
Epoch [13/30], Train Loss: 0.0894, Validation Loss: 0.4141
Epoch [14/30], Train Loss: 0.0676, Validation Loss: 0.4153
Epoch [15/30], Train Loss: 0.0500, Validation Loss: 0.4142
Epoch [16/30], Train Loss: 0.0435, Validation Loss: 0.4036
Epoch [17/30], Train Loss: 0.0385, Validation Loss: 0.4139
Epoch [18/30], Train Loss: 0.0326, Validation Loss: 0.4085
Epoch [19/30], Train Loss: 0.0235, Validation Loss: 0.4172
Epoch [20/30], Train Loss: 0.0185, Validation Loss: 0.4094
Epoch [21/30], Train Loss: 0.0166, Validation Loss: 0.4118
Epoch [22/30], Train Loss: 0.0169, Validation Loss: 0.4117
Epoch [23/30], Train Loss: 0.0109, Validation Loss: 0.4197
Epoch [24/30], Train Loss: 0.0109, Validation Loss: 0.4124
Epoch [25/30], Train Loss: 0.0117, Validation Loss: 0.4218
Epoch [26/30], Train Loss: 0.0089, Validation Loss: 0.4149
Epoch [27/30], Train Loss: 0.0080, Validation Loss: 0.4188
Epoch [28/30], Train Loss: 0.0080, Validation Loss: 0.4131
Epoch [29/30], Train Loss: 0.0103, Validation Loss: 0.4214
Epoch [30/30], Train Loss: 0.0124, Validation Loss: 0.4198
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_C']/fold1/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_C']/fold1/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_C']/fold1/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_C']/fold1/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_C): R^2 Score = 0.775, MSE = 0.891
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.052724 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407183
[LightGBM] [Info] Number of data points in the train set: 1223, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(383, 1)
(383, 1597)
fold1
RF：
決定係数：0.7322505794188913
MAE：0.9776219988032396
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold1/RF/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold1/RF/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold1/RF/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
XGB：
決定係数：0.7079217683459709
MAE：0.9942629933357239
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold1/XGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold1/XGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold1/XGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
LGB：
決定係数：0.7534197048263941
MAE：0.9258358527703072
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold1/LGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold1/LGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold1/LGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1223, 1597)
特徴選択後：(1223, 1597)
torch.Size([1223, 1597])
学習データ数: 1223
検証データ数: 306
テストデータ数: 383
Epoch [1/30], Train Loss: 0.9560, Validation Loss: 0.9244
Epoch [2/30], Train Loss: 0.8545, Validation Loss: 0.8456
Epoch [3/30], Train Loss: 0.7677, Validation Loss: 0.7601
Epoch [4/30], Train Loss: 0.6820, Validation Loss: 0.6744
Epoch [5/30], Train Loss: 0.5698, Validation Loss: 0.5825
Epoch [6/30], Train Loss: 0.4679, Validation Loss: 0.5259
Epoch [7/30], Train Loss: 0.3622, Validation Loss: 0.4373
Epoch [8/30], Train Loss: 0.2826, Validation Loss: 0.3783
Epoch [9/30], Train Loss: 0.2264, Validation Loss: 0.3383
Epoch [10/30], Train Loss: 0.1788, Validation Loss: 0.3215
Epoch [11/30], Train Loss: 0.1427, Validation Loss: 0.3183
Epoch [12/30], Train Loss: 0.1144, Validation Loss: 0.3102
Epoch [13/30], Train Loss: 0.1034, Validation Loss: 0.3158
Epoch [14/30], Train Loss: 0.0774, Validation Loss: 0.3150
Epoch [15/30], Train Loss: 0.0600, Validation Loss: 0.3169
Epoch [16/30], Train Loss: 0.0483, Validation Loss: 0.3252
Epoch [17/30], Train Loss: 0.0395, Validation Loss: 0.3154
Epoch [18/30], Train Loss: 0.0302, Validation Loss: 0.3259
Epoch [19/30], Train Loss: 0.0292, Validation Loss: 0.3171
Epoch [20/30], Train Loss: 0.0245, Validation Loss: 0.3225
Epoch [21/30], Train Loss: 0.0247, Validation Loss: 0.3335
Epoch [22/30], Train Loss: 0.0205, Validation Loss: 0.3201
Epoch [23/30], Train Loss: 0.0151, Validation Loss: 0.3259
Epoch [24/30], Train Loss: 0.0162, Validation Loss: 0.3309
Epoch [25/30], Train Loss: 0.0108, Validation Loss: 0.3160
Epoch [26/30], Train Loss: 0.0094, Validation Loss: 0.3247
Epoch [27/30], Train Loss: 0.0115, Validation Loss: 0.3200
Epoch [28/30], Train Loss: 0.0106, Validation Loss: 0.3248
Epoch [29/30], Train Loss: 0.0143, Validation Loss: 0.3241
Epoch [30/30], Train Loss: 0.0070, Validation Loss: 0.3219
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_C']/fold2/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_C']/fold2/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_C']/fold2/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_C']/fold2/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_C): R^2 Score = 0.728, MSE = 0.947
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.087078 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407194
[LightGBM] [Info] Number of data points in the train set: 1223, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(383, 1)
(383, 1597)
fold2
RF：
決定係数：0.675340905465947
MAE：1.0092600163387104
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold2/RF/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold2/RF/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold2/RF/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
XGB：
決定係数：0.6477096214364209
MAE：1.0694576501846313
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold2/XGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold2/XGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold2/XGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
LGB：
決定係数：0.6917668085235548
MAE：1.012803662717223
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold2/LGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold2/LGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold2/LGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1224, 1597)
特徴選択後：(1224, 1597)
torch.Size([1224, 1597])
学習データ数: 1224
検証データ数: 306
テストデータ数: 382
Epoch [1/30], Train Loss: 0.9911, Validation Loss: 1.0018
Epoch [2/30], Train Loss: 0.8544, Validation Loss: 0.9188
Epoch [3/30], Train Loss: 0.7745, Validation Loss: 0.8322
Epoch [4/30], Train Loss: 0.6805, Validation Loss: 0.7506
Epoch [5/30], Train Loss: 0.5936, Validation Loss: 0.6727
Epoch [6/30], Train Loss: 0.4873, Validation Loss: 0.5854
Epoch [7/30], Train Loss: 0.3898, Validation Loss: 0.4900
Epoch [8/30], Train Loss: 0.3041, Validation Loss: 0.4273
Epoch [9/30], Train Loss: 0.2501, Validation Loss: 0.3960
Epoch [10/30], Train Loss: 0.2005, Validation Loss: 0.3677
Epoch [11/30], Train Loss: 0.1684, Validation Loss: 0.3588
Epoch [12/30], Train Loss: 0.1406, Validation Loss: 0.3628
Epoch [13/30], Train Loss: 0.1100, Validation Loss: 0.3466
Epoch [14/30], Train Loss: 0.0868, Validation Loss: 0.3511
Epoch [15/30], Train Loss: 0.0733, Validation Loss: 0.3559
Epoch [16/30], Train Loss: 0.0615, Validation Loss: 0.3628
Epoch [17/30], Train Loss: 0.0467, Validation Loss: 0.3922
Epoch [18/30], Train Loss: 0.0342, Validation Loss: 0.3533
Epoch [19/30], Train Loss: 0.0307, Validation Loss: 0.3723
Epoch [20/30], Train Loss: 0.0253, Validation Loss: 0.3617
Epoch [21/30], Train Loss: 0.0176, Validation Loss: 0.3615
Epoch [22/30], Train Loss: 0.0190, Validation Loss: 0.3703
Epoch [23/30], Train Loss: 0.0214, Validation Loss: 0.3625
Epoch [24/30], Train Loss: 0.0148, Validation Loss: 0.3605
Epoch [25/30], Train Loss: 0.0151, Validation Loss: 0.3859
Epoch [26/30], Train Loss: 0.0136, Validation Loss: 0.3617
Epoch [27/30], Train Loss: 0.0080, Validation Loss: 0.3635
Epoch [28/30], Train Loss: 0.0053, Validation Loss: 0.3672
Epoch [29/30], Train Loss: 0.0123, Validation Loss: 0.3609
Epoch [30/30], Train Loss: 0.0053, Validation Loss: 0.3628
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_C']/fold3/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_C']/fold3/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_C']/fold3/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_C']/fold3/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_C): R^2 Score = 0.743, MSE = 1.025
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.062135 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407204
[LightGBM] [Info] Number of data points in the train set: 1224, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(382, 1)
(382, 1597)
fold3
RF：
決定係数：0.7227536968244459
MAE：1.0499415060627921
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold3/RF/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold3/RF/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold3/RF/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
XGB：
決定係数：0.7346967844276994
MAE：1.0133404731750488
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold3/XGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold3/XGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold3/XGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
LGB：
決定係数：0.7479372323627226
MAE：0.9780567586953164
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold3/LGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold3/LGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold3/LGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1224, 1597)
特徴選択後：(1224, 1597)
torch.Size([1224, 1597])
学習データ数: 1224
検証データ数: 306
テストデータ数: 382
Epoch [1/30], Train Loss: 0.9947, Validation Loss: 0.8891
Epoch [2/30], Train Loss: 0.8650, Validation Loss: 0.8233
Epoch [3/30], Train Loss: 0.7695, Validation Loss: 0.7474
Epoch [4/30], Train Loss: 0.6636, Validation Loss: 0.6791
Epoch [5/30], Train Loss: 0.5677, Validation Loss: 0.6286
Epoch [6/30], Train Loss: 0.4577, Validation Loss: 0.5616
Epoch [7/30], Train Loss: 0.3526, Validation Loss: 0.4832
Epoch [8/30], Train Loss: 0.2779, Validation Loss: 0.4254
Epoch [9/30], Train Loss: 0.2250, Validation Loss: 0.3979
Epoch [10/30], Train Loss: 0.1776, Validation Loss: 0.3794
Epoch [11/30], Train Loss: 0.1381, Validation Loss: 0.3752
Epoch [12/30], Train Loss: 0.1032, Validation Loss: 0.3736
Epoch [13/30], Train Loss: 0.0847, Validation Loss: 0.3765
Epoch [14/30], Train Loss: 0.0659, Validation Loss: 0.3810
Epoch [15/30], Train Loss: 0.0503, Validation Loss: 0.3832
Epoch [16/30], Train Loss: 0.0377, Validation Loss: 0.3852
Epoch [17/30], Train Loss: 0.0340, Validation Loss: 0.3872
Epoch [18/30], Train Loss: 0.0247, Validation Loss: 0.3944
Epoch [19/30], Train Loss: 0.0214, Validation Loss: 0.3915
Epoch [20/30], Train Loss: 0.0165, Validation Loss: 0.3936
Epoch [21/30], Train Loss: 0.0145, Validation Loss: 0.3960
Epoch [22/30], Train Loss: 0.0202, Validation Loss: 0.3944
Epoch [23/30], Train Loss: 0.0201, Validation Loss: 0.3988
Epoch [24/30], Train Loss: 0.0095, Validation Loss: 0.3996
Epoch [25/30], Train Loss: 0.0103, Validation Loss: 0.3933
Epoch [26/30], Train Loss: 0.0091, Validation Loss: 0.3956
Epoch [27/30], Train Loss: 0.0105, Validation Loss: 0.3961
Epoch [28/30], Train Loss: 0.0106, Validation Loss: 0.3947
Epoch [29/30], Train Loss: 0.0090, Validation Loss: 0.3990
Epoch [30/30], Train Loss: 0.0077, Validation Loss: 0.4039
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_C']/fold4/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_C']/fold4/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_C']/fold4/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_C']/fold4/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_C): R^2 Score = 0.793, MSE = 0.882
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.055522 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407190
[LightGBM] [Info] Number of data points in the train set: 1224, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(382, 1)
(382, 1597)
fold4
RF：
決定係数：0.7817803581506999
MAE：0.9102015136036529
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold4/RF/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold4/RF/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold4/RF/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
XGB：
決定係数：0.7373308886223346
MAE：0.921297550201416
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold4/XGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold4/XGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold4/XGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
LGB：
決定係数：0.7885230899693287
MAE：0.8864934039718446
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold4/LGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold4/LGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold4/LGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1224, 1597)
特徴選択後：(1224, 1597)
torch.Size([1224, 1597])
学習データ数: 1224
検証データ数: 306
テストデータ数: 382
Epoch [1/30], Train Loss: 0.9774, Validation Loss: 1.0090
Epoch [2/30], Train Loss: 0.8661, Validation Loss: 0.9336
Epoch [3/30], Train Loss: 0.7760, Validation Loss: 0.8553
Epoch [4/30], Train Loss: 0.6869, Validation Loss: 0.7821
Epoch [5/30], Train Loss: 0.5784, Validation Loss: 0.7306
Epoch [6/30], Train Loss: 0.4763, Validation Loss: 0.6590
Epoch [7/30], Train Loss: 0.3797, Validation Loss: 0.5810
Epoch [8/30], Train Loss: 0.2919, Validation Loss: 0.5047
Epoch [9/30], Train Loss: 0.2356, Validation Loss: 0.4617
Epoch [10/30], Train Loss: 0.1873, Validation Loss: 0.4433
Epoch [11/30], Train Loss: 0.1550, Validation Loss: 0.4318
Epoch [12/30], Train Loss: 0.1267, Validation Loss: 0.4262
Epoch [13/30], Train Loss: 0.0918, Validation Loss: 0.4261
Epoch [14/30], Train Loss: 0.0761, Validation Loss: 0.4254
Epoch [15/30], Train Loss: 0.0645, Validation Loss: 0.4283
Epoch [16/30], Train Loss: 0.0521, Validation Loss: 0.4241
Epoch [17/30], Train Loss: 0.0367, Validation Loss: 0.4298
Epoch [18/30], Train Loss: 0.0320, Validation Loss: 0.4321
Epoch [19/30], Train Loss: 0.0264, Validation Loss: 0.4332
Epoch [20/30], Train Loss: 0.0228, Validation Loss: 0.4371
Epoch [21/30], Train Loss: 0.0177, Validation Loss: 0.4366
Epoch [22/30], Train Loss: 0.0196, Validation Loss: 0.4503
Epoch [23/30], Train Loss: 0.0219, Validation Loss: 0.4440
Epoch [24/30], Train Loss: 0.0151, Validation Loss: 0.4503
Epoch [25/30], Train Loss: 0.0114, Validation Loss: 0.4378
Epoch [26/30], Train Loss: 0.0127, Validation Loss: 0.4380
Epoch [27/30], Train Loss: 0.0079, Validation Loss: 0.4431
Epoch [28/30], Train Loss: 0.0114, Validation Loss: 0.4477
Epoch [29/30], Train Loss: 0.0143, Validation Loss: 0.4395
Epoch [30/30], Train Loss: 0.0083, Validation Loss: 0.4420
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_C']/fold5/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_C']/fold5/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_C']/fold5/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_C']/fold5/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_C): R^2 Score = 0.815, MSE = 0.941
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.081728 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407183
[LightGBM] [Info] Number of data points in the train set: 1224, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(382, 1)
(382, 1597)
fold5
RF：
決定係数：0.7365615217274042
MAE：1.0669000839959226
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold5/RF/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold5/RF/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold5/RF/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
XGB：
決定係数：0.6706667558212579
MAE：1.1325644254684448
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold5/XGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold5/XGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold5/XGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
LGB：
決定係数：0.7597996902773488
MAE：1.027712148466649
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_C']/fold5/LGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_C']/fold5/LGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_C']/fold5/LGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
{'MAE': {'LGB': {'Total_C': '0.966±0.053'},
         'RF': {'Total_C': '1.003±0.056'},
         'ST': {'Total_C': '0.937±0.051'},
         'XGB': {'Total_C': '1.026±0.071'}},
 'R': {'LGB': {'Total_C': '0.748±0.032'},
       'RF': {'Total_C': '0.730±0.034'},
       'ST': {'Total_C': '0.771±0.032'},
       'XGB': {'Total_C': '0.700±0.035'}}}
CSVファイル 'result.csv' を作成しました。
      d__Archaea;p__Aenigmarchaeota;c__Aenigmarchaeia;o__Aenigmarchaeales;f__Aenigmarchaeales;g__Aenigmarchaeales  ...  d__Eukaryota;p__Zoopagomycota;c__Incertae_Sedis;o__Kickxellales;f__Kickxellaceae;g__Spiromyces
0                                          6.062568e-16                                                            ...                                         -15.059084                                             
1                                         -5.764302e-16                                                            ...                                         -14.219160                                             
2                                         -2.289340e-16                                                            ...                                         -16.880591                                             
3                                         -3.333994e-16                                                            ...                                         -13.378841                                             
4                                         -2.670371e-16                                                            ...                                         -19.951495                                             
...                                                 ...                                                            ...                                                ...                                             
2528                                      -1.002237e-15                                                            ...                                         -24.967522                                             
2529                                       5.778600e-16                                                            ...                                         -14.915955                                             
2530                                       9.118953e-16                                                            ...                                         -30.976300                                             
2531                                      -2.984998e-16                                                            ...                                         -22.024191                                             
2532                                       0.000000e+00                                                            ...                                         -23.285132                                             

[1919 rows x 1597 columns]
特徴選択前：(1228, 1597)
特徴選択後：(1228, 1597)
torch.Size([1228, 1597])
学習データ数: 1228
検証データ数: 307
テストデータ数: 384
Epoch [1/30], Train Loss: 0.9491, Validation Loss: 2.0459
Epoch [2/30], Train Loss: 0.8859, Validation Loss: 1.9823
Epoch [3/30], Train Loss: 0.7847, Validation Loss: 1.9257
Epoch [4/30], Train Loss: 0.7057, Validation Loss: 1.8986
Epoch [5/30], Train Loss: 0.6325, Validation Loss: 1.8656
Epoch [6/30], Train Loss: 0.5508, Validation Loss: 1.7567
Epoch [7/30], Train Loss: 0.4789, Validation Loss: 1.6741
Epoch [8/30], Train Loss: 0.4150, Validation Loss: 1.5403
Epoch [9/30], Train Loss: 0.3528, Validation Loss: 1.4752
Epoch [10/30], Train Loss: 0.3421, Validation Loss: 1.4313
Epoch [11/30], Train Loss: 0.2569, Validation Loss: 1.3498
Epoch [12/30], Train Loss: 0.2152, Validation Loss: 1.3372
Epoch [13/30], Train Loss: 0.1826, Validation Loss: 1.2664
Epoch [14/30], Train Loss: 0.1527, Validation Loss: 1.2741
Epoch [15/30], Train Loss: 0.1354, Validation Loss: 1.2318
Epoch [16/30], Train Loss: 0.1155, Validation Loss: 1.1880
Epoch [17/30], Train Loss: 0.1131, Validation Loss: 1.1900
Epoch [18/30], Train Loss: 0.0841, Validation Loss: 1.1473
Epoch [19/30], Train Loss: 0.0685, Validation Loss: 1.1300
Epoch [20/30], Train Loss: 0.0587, Validation Loss: 1.0949
Epoch [21/30], Train Loss: 0.0480, Validation Loss: 1.1050
Epoch [22/30], Train Loss: 0.0484, Validation Loss: 1.0868
Epoch [23/30], Train Loss: 0.0425, Validation Loss: 1.0572
Epoch [24/30], Train Loss: 0.0419, Validation Loss: 1.0660
Epoch [25/30], Train Loss: 0.0252, Validation Loss: 1.0612
Epoch [26/30], Train Loss: 0.0321, Validation Loss: 1.0327
Epoch [27/30], Train Loss: 0.0222, Validation Loss: 1.0376
Epoch [28/30], Train Loss: 0.0177, Validation Loss: 1.0311
Epoch [29/30], Train Loss: 0.0232, Validation Loss: 1.0199
Epoch [30/30], Train Loss: 0.0215, Validation Loss: 1.0358
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_N']/fold1/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_N']/fold1/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_N']/fold1/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_N']/fold1/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_N): R^2 Score = 0.498, MSE = 0.113
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.053626 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407179
[LightGBM] [Info] Number of data points in the train set: 1228, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(384, 1)
(384, 1597)
fold1
RF：
決定係数：0.34437737669567653
MAE：0.11517960920645703
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold1/RF/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold1/RF/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold1/RF/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
XGB：
決定係数：0.5667304053013646
MAE：0.11219235509634018
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold1/XGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold1/XGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold1/XGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
LGB：
決定係数：0.5029049962304966
MAE：0.10749591822792565
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold1/LGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold1/LGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold1/LGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1228, 1597)
特徴選択後：(1228, 1597)
torch.Size([1228, 1597])
学習データ数: 1228
検証データ数: 307
テストデータ数: 384
Epoch [1/30], Train Loss: 0.9669, Validation Loss: 0.5809
Epoch [2/30], Train Loss: 0.8958, Validation Loss: 0.5509
Epoch [3/30], Train Loss: 0.8968, Validation Loss: 0.5145
Epoch [4/30], Train Loss: 0.7913, Validation Loss: 0.4778
Epoch [5/30], Train Loss: 0.7834, Validation Loss: 0.4442
Epoch [6/30], Train Loss: 0.7062, Validation Loss: 0.4149
Epoch [7/30], Train Loss: 0.6212, Validation Loss: 0.3897
Epoch [8/30], Train Loss: 0.6113, Validation Loss: 0.3734
Epoch [9/30], Train Loss: 0.5151, Validation Loss: 0.3648
Epoch [10/30], Train Loss: 0.4653, Validation Loss: 0.3716
Epoch [11/30], Train Loss: 0.4438, Validation Loss: 0.3658
Epoch [12/30], Train Loss: 0.3634, Validation Loss: 0.3787
Epoch [13/30], Train Loss: 0.3115, Validation Loss: 0.3895
Epoch [14/30], Train Loss: 0.2717, Validation Loss: 0.4019
Epoch [15/30], Train Loss: 0.2438, Validation Loss: 0.4139
Epoch [16/30], Train Loss: 0.1912, Validation Loss: 0.4317
Epoch [17/30], Train Loss: 0.1708, Validation Loss: 0.4192
Epoch [18/30], Train Loss: 0.1450, Validation Loss: 0.4454
Epoch [19/30], Train Loss: 0.0986, Validation Loss: 0.4288
Epoch [20/30], Train Loss: 0.0787, Validation Loss: 0.4494
Epoch [21/30], Train Loss: 0.0640, Validation Loss: 0.4619
Epoch [22/30], Train Loss: 0.0515, Validation Loss: 0.4613
Epoch [23/30], Train Loss: 0.0382, Validation Loss: 0.4833
Epoch [24/30], Train Loss: 0.0287, Validation Loss: 0.5173
Epoch [25/30], Train Loss: 0.0384, Validation Loss: 0.4619
Epoch [26/30], Train Loss: 0.0237, Validation Loss: 0.5491
Epoch [27/30], Train Loss: 0.0195, Validation Loss: 0.4806
Epoch [28/30], Train Loss: 0.0156, Validation Loss: 0.4723
Epoch [29/30], Train Loss: 0.0121, Validation Loss: 0.5407
Epoch [30/30], Train Loss: 0.0107, Validation Loss: 0.4976
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_N']/fold2/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_N']/fold2/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_N']/fold2/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_N']/fold2/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_N): R^2 Score = 0.610, MSE = 0.117
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.068758 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407184
[LightGBM] [Info] Number of data points in the train set: 1228, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(384, 1)
(384, 1597)
fold2
RF：
決定係数：0.3734970833818895
MAE：0.10294747896925445
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold2/RF/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold2/RF/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold2/RF/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
XGB：
決定係数：0.4270717117183515
MAE：0.10111168026924133
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold2/XGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold2/XGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold2/XGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
LGB：
決定係数：0.6912094134435411
MAE：0.0959015380673373
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold2/LGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold2/LGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold2/LGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1228, 1597)
特徴選択後：(1228, 1597)
torch.Size([1228, 1597])
学習データ数: 1228
検証データ数: 307
テストデータ数: 384
Epoch [1/30], Train Loss: 1.0741, Validation Loss: 1.6376
Epoch [2/30], Train Loss: 0.9136, Validation Loss: 1.6023
Epoch [3/30], Train Loss: 0.9009, Validation Loss: 1.5647
Epoch [4/30], Train Loss: 0.8442, Validation Loss: 1.5224
Epoch [5/30], Train Loss: 0.7572, Validation Loss: 1.4768
Epoch [6/30], Train Loss: 0.7009, Validation Loss: 1.4260
Epoch [7/30], Train Loss: 0.7420, Validation Loss: 1.3699
Epoch [8/30], Train Loss: 0.5993, Validation Loss: 1.3211
Epoch [9/30], Train Loss: 0.5771, Validation Loss: 1.2797
Epoch [10/30], Train Loss: 0.5420, Validation Loss: 1.2487
Epoch [11/30], Train Loss: 0.4632, Validation Loss: 1.2227
Epoch [12/30], Train Loss: 0.4302, Validation Loss: 1.2080
Epoch [13/30], Train Loss: 0.3724, Validation Loss: 1.2036
Epoch [14/30], Train Loss: 0.3269, Validation Loss: 1.1891
Epoch [15/30], Train Loss: 0.2905, Validation Loss: 1.1938
Epoch [16/30], Train Loss: 0.2248, Validation Loss: 1.1664
Epoch [17/30], Train Loss: 0.1893, Validation Loss: 1.1851
Epoch [18/30], Train Loss: 0.1468, Validation Loss: 1.1457
Epoch [19/30], Train Loss: 0.1236, Validation Loss: 1.1723
Epoch [20/30], Train Loss: 0.1075, Validation Loss: 1.1268
Epoch [21/30], Train Loss: 0.0750, Validation Loss: 1.1423
Epoch [22/30], Train Loss: 0.0591, Validation Loss: 1.1034
Epoch [23/30], Train Loss: 0.0433, Validation Loss: 1.0978
Epoch [24/30], Train Loss: 0.0273, Validation Loss: 1.1145
Epoch [25/30], Train Loss: 0.0315, Validation Loss: 1.0689
Epoch [26/30], Train Loss: 0.0253, Validation Loss: 1.0896
Epoch [27/30], Train Loss: 0.0302, Validation Loss: 1.0736
Epoch [28/30], Train Loss: 0.0211, Validation Loss: 1.1005
Epoch [29/30], Train Loss: 0.0214, Validation Loss: 1.0827
Epoch [30/30], Train Loss: 0.0116, Validation Loss: 1.0655
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_N']/fold3/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_N']/fold3/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_N']/fold3/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_N']/fold3/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_N): R^2 Score = 0.553, MSE = 0.116
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.041286 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407194
[LightGBM] [Info] Number of data points in the train set: 1228, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(384, 1)
(384, 1597)
fold3
RF：
決定係数：0.32733247047918657
MAE：0.10498773791441392
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold3/RF/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold3/RF/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold3/RF/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
XGB：
決定係数：0.36736958268326647
MAE：0.1004708781838417
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold3/XGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold3/XGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold3/XGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
LGB：
決定係数：0.3631840666736817
MAE：0.10932229866827152
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold3/LGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold3/LGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold3/LGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1228, 1597)
特徴選択後：(1228, 1597)
torch.Size([1228, 1597])
学習データ数: 1228
検証データ数: 307
テストデータ数: 384
Epoch [1/30], Train Loss: 0.9723, Validation Loss: 1.1811
Epoch [2/30], Train Loss: 0.8931, Validation Loss: 1.1501
Epoch [3/30], Train Loss: 0.9179, Validation Loss: 1.1208
Epoch [4/30], Train Loss: 0.8236, Validation Loss: 1.0893
Epoch [5/30], Train Loss: 0.7098, Validation Loss: 1.0578
Epoch [6/30], Train Loss: 0.6453, Validation Loss: 1.0200
Epoch [7/30], Train Loss: 0.5920, Validation Loss: 0.9870
Epoch [8/30], Train Loss: 0.5155, Validation Loss: 0.9565
Epoch [9/30], Train Loss: 0.4556, Validation Loss: 0.9409
Epoch [10/30], Train Loss: 0.4033, Validation Loss: 0.9147
Epoch [11/30], Train Loss: 0.4125, Validation Loss: 0.9305
Epoch [12/30], Train Loss: 0.2719, Validation Loss: 0.9093
Epoch [13/30], Train Loss: 0.2276, Validation Loss: 0.9249
Epoch [14/30], Train Loss: 0.1890, Validation Loss: 0.9032
Epoch [15/30], Train Loss: 0.1518, Validation Loss: 0.9021
Epoch [16/30], Train Loss: 0.1238, Validation Loss: 0.8851
Epoch [17/30], Train Loss: 0.1076, Validation Loss: 0.8970
Epoch [18/30], Train Loss: 0.0838, Validation Loss: 0.8890
Epoch [19/30], Train Loss: 0.0699, Validation Loss: 0.8883
Epoch [20/30], Train Loss: 0.0555, Validation Loss: 0.8896
Epoch [21/30], Train Loss: 0.0492, Validation Loss: 0.8917
Epoch [22/30], Train Loss: 0.0430, Validation Loss: 0.9004
Epoch [23/30], Train Loss: 0.0264, Validation Loss: 0.8864
Epoch [24/30], Train Loss: 0.0236, Validation Loss: 0.8942
Epoch [25/30], Train Loss: 0.0174, Validation Loss: 0.8784
Epoch [26/30], Train Loss: 0.0131, Validation Loss: 0.8816
Epoch [27/30], Train Loss: 0.0219, Validation Loss: 0.8902
Epoch [28/30], Train Loss: 0.0119, Validation Loss: 0.8869
Epoch [29/30], Train Loss: 0.0106, Validation Loss: 0.8884
Epoch [30/30], Train Loss: 0.0105, Validation Loss: 0.8808
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_N']/fold4/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_N']/fold4/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_N']/fold4/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_N']/fold4/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_N): R^2 Score = 0.627, MSE = 0.100
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.046859 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407196
[LightGBM] [Info] Number of data points in the train set: 1228, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(384, 1)
(384, 1597)
fold4
RF：
決定係数：0.5365095080093624
MAE：0.09243172225621855
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold4/RF/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold4/RF/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold4/RF/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
XGB：
決定係数：0.6735219202696954
MAE：0.08520693331956863
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold4/XGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold4/XGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold4/XGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
LGB：
決定係数：0.6145400657166961
MAE：0.09237171603569959
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold4/LGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold4/LGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold4/LGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1228, 1597)
特徴選択後：(1228, 1597)
torch.Size([1228, 1597])
学習データ数: 1228
検証データ数: 308
テストデータ数: 383
Epoch [1/30], Train Loss: 0.9543, Validation Loss: 0.7017
Epoch [2/30], Train Loss: 0.9435, Validation Loss: 0.6759
Epoch [3/30], Train Loss: 0.8374, Validation Loss: 0.6547
Epoch [4/30], Train Loss: 0.8340, Validation Loss: 0.6363
Epoch [5/30], Train Loss: 0.7454, Validation Loss: 0.6243
Epoch [6/30], Train Loss: 0.7048, Validation Loss: 0.6004
Epoch [7/30], Train Loss: 0.6037, Validation Loss: 0.5991
Epoch [8/30], Train Loss: 0.5454, Validation Loss: 0.5895
Epoch [9/30], Train Loss: 0.4931, Validation Loss: 0.5936
Epoch [10/30], Train Loss: 0.4452, Validation Loss: 0.6044
Epoch [11/30], Train Loss: 0.4011, Validation Loss: 0.6055
Epoch [12/30], Train Loss: 0.3285, Validation Loss: 0.6229
Epoch [13/30], Train Loss: 0.3141, Validation Loss: 0.6168
Epoch [14/30], Train Loss: 0.2249, Validation Loss: 0.6497
Epoch [15/30], Train Loss: 0.1810, Validation Loss: 0.6549
Epoch [16/30], Train Loss: 0.1453, Validation Loss: 0.6677
Epoch [17/30], Train Loss: 0.1293, Validation Loss: 0.6807
Epoch [18/30], Train Loss: 0.1106, Validation Loss: 0.7986
Epoch [19/30], Train Loss: 0.1154, Validation Loss: 0.7188
Epoch [20/30], Train Loss: 0.0683, Validation Loss: 0.8292
Epoch [21/30], Train Loss: 0.0498, Validation Loss: 0.7397
Epoch [22/30], Train Loss: 0.0414, Validation Loss: 0.8252
Epoch [23/30], Train Loss: 0.0298, Validation Loss: 0.7743
Epoch [24/30], Train Loss: 0.0332, Validation Loss: 0.8622
Epoch [25/30], Train Loss: 0.0251, Validation Loss: 0.7766
Epoch [26/30], Train Loss: 0.0152, Validation Loss: 0.8229
Epoch [27/30], Train Loss: 0.0122, Validation Loss: 0.7721
Epoch [28/30], Train Loss: 0.0148, Validation Loss: 0.8320
Epoch [29/30], Train Loss: 0.0142, Validation Loss: 0.7788
Epoch [30/30], Train Loss: 0.0091, Validation Loss: 0.8149
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_N']/fold5/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_N']/fold5/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['Total_N']/fold5/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['Total_N']/fold5/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_N): R^2 Score = 0.586, MSE = 0.110
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.087554 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407185
[LightGBM] [Info] Number of data points in the train set: 1228, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(383, 1)
(383, 1597)
fold5
RF：
決定係数：0.47014334941667213
MAE：0.08616582948497341
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold5/RF/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold5/RF/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold5/RF/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
XGB：
決定係数：0.5549243102697974
MAE：0.08773112297058105
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold5/XGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold5/XGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold5/XGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
LGB：
決定係数：0.5173413989463264
MAE：0.08996176462555464
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['Total_N']/fold5/LGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['Total_N']/fold5/LGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['Total_N']/fold5/LGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
{'MAE': {'LGB': {'Total_N': '0.099±0.008'},
         'RF': {'Total_N': '0.100±0.010'},
         'ST': {'Total_N': '0.111±0.006'},
         'XGB': {'Total_N': '0.097±0.010'}},
 'R': {'LGB': {'Total_N': '0.538±0.111'},
       'RF': {'Total_N': '0.410±0.080'},
       'ST': {'Total_N': '0.575±0.046'},
       'XGB': {'Total_N': '0.518±0.109'}}}
CSVファイル 'result.csv' を作成しました。
      d__Archaea;p__Aenigmarchaeota;c__Aenigmarchaeia;o__Aenigmarchaeales;f__Aenigmarchaeales;g__Aenigmarchaeales  ...  d__Eukaryota;p__Zoopagomycota;c__Incertae_Sedis;o__Kickxellales;f__Kickxellaceae;g__Spiromyces
0                                          6.062568e-16                                                            ...                                         -15.059084                                             
1                                         -5.764302e-16                                                            ...                                         -14.219160                                             
2                                         -2.289340e-16                                                            ...                                         -16.880591                                             
3                                         -3.333994e-16                                                            ...                                         -13.378841                                             
4                                         -2.670371e-16                                                            ...                                         -19.951495                                             
...                                                 ...                                                            ...                                                ...                                             
2528                                      -1.002237e-15                                                            ...                                         -24.967522                                             
2529                                       5.778600e-16                                                            ...                                         -14.915955                                             
2530                                       9.118953e-16                                                            ...                                         -30.976300                                             
2531                                      -2.984998e-16                                                            ...                                         -22.024191                                             
2532                                       0.000000e+00                                                            ...                                         -23.285132                                             

[1763 rows x 1597 columns]
特徴選択前：(1128, 1597)
特徴選択後：(1128, 1597)
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 4.9687, Validation Loss: 3.7762
Epoch [2/30], Train Loss: 4.6541, Validation Loss: 3.5286
Epoch [3/30], Train Loss: 4.3886, Validation Loss: 3.2625
Epoch [4/30], Train Loss: 4.0691, Validation Loss: 2.9825
Epoch [5/30], Train Loss: 3.7720, Validation Loss: 2.7185
Epoch [6/30], Train Loss: 3.4549, Validation Loss: 2.4779
Epoch [7/30], Train Loss: 3.0799, Validation Loss: 2.2670
Epoch [8/30], Train Loss: 2.7640, Validation Loss: 2.0795
Epoch [9/30], Train Loss: 2.4819, Validation Loss: 1.8824
Epoch [10/30], Train Loss: 2.1950, Validation Loss: 1.7219
Epoch [11/30], Train Loss: 1.9653, Validation Loss: 1.6059
Epoch [12/30], Train Loss: 1.7289, Validation Loss: 1.5418
Epoch [13/30], Train Loss: 1.5580, Validation Loss: 1.5000
Epoch [14/30], Train Loss: 1.3678, Validation Loss: 1.5039
Epoch [15/30], Train Loss: 1.2081, Validation Loss: 1.4862
Epoch [16/30], Train Loss: 1.0907, Validation Loss: 1.5248
Epoch [17/30], Train Loss: 0.9620, Validation Loss: 1.5419
Epoch [18/30], Train Loss: 0.8442, Validation Loss: 1.5530
Epoch [19/30], Train Loss: 0.7729, Validation Loss: 1.5673
Epoch [20/30], Train Loss: 0.6664, Validation Loss: 1.5591
Epoch [21/30], Train Loss: 0.6105, Validation Loss: 1.5948
Epoch [22/30], Train Loss: 0.5402, Validation Loss: 1.6220
Epoch [23/30], Train Loss: 0.4895, Validation Loss: 1.6355
Epoch [24/30], Train Loss: 0.4573, Validation Loss: 1.6508
Epoch [25/30], Train Loss: 0.3692, Validation Loss: 1.6566
Epoch [26/30], Train Loss: 0.3465, Validation Loss: 1.6769
Epoch [27/30], Train Loss: 0.3218, Validation Loss: 1.6896
Epoch [28/30], Train Loss: 0.2893, Validation Loss: 1.6806
Epoch [29/30], Train Loss: 0.2615, Validation Loss: 1.7335
Epoch [30/30], Train Loss: 0.2373, Validation Loss: 1.7317
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/MT/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/MT/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/MT/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/MT/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.673, MSE = 0.366
Output 2 (available_P): R^2 Score = 0.779, MSE = 410.915
Output 3 (EC_electric_conductivity): R^2 Score = 0.705, MSE = 0.193
Output 4 (Total_C): R^2 Score = 0.797, MSE = 0.913
Output 5 (Total_N): R^2 Score = 0.656, MSE = 0.085
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 4.9663, Validation Loss: 3.6711
Epoch [2/30], Train Loss: 4.6378, Validation Loss: 3.3931
Epoch [3/30], Train Loss: 4.3351, Validation Loss: 3.0767
Epoch [4/30], Train Loss: 3.9710, Validation Loss: 2.7859
Epoch [5/30], Train Loss: 3.6796, Validation Loss: 2.5119
Epoch [6/30], Train Loss: 3.2830, Validation Loss: 2.2903
Epoch [7/30], Train Loss: 2.9759, Validation Loss: 2.0975
Epoch [8/30], Train Loss: 2.6462, Validation Loss: 1.9157
Epoch [9/30], Train Loss: 2.3816, Validation Loss: 1.7295
Epoch [10/30], Train Loss: 2.1542, Validation Loss: 1.5866
Epoch [11/30], Train Loss: 1.9233, Validation Loss: 1.4915
Epoch [12/30], Train Loss: 1.6920, Validation Loss: 1.4370
Epoch [13/30], Train Loss: 1.5161, Validation Loss: 1.4043
Epoch [14/30], Train Loss: 1.3759, Validation Loss: 1.3906
Epoch [15/30], Train Loss: 1.2065, Validation Loss: 1.4121
Epoch [16/30], Train Loss: 1.0864, Validation Loss: 1.3987
Epoch [17/30], Train Loss: 0.9741, Validation Loss: 1.4345
Epoch [18/30], Train Loss: 0.8826, Validation Loss: 1.4467
Epoch [19/30], Train Loss: 0.7838, Validation Loss: 1.4617
Epoch [20/30], Train Loss: 0.6968, Validation Loss: 1.4769
Epoch [21/30], Train Loss: 0.6117, Validation Loss: 1.5227
Epoch [22/30], Train Loss: 0.5520, Validation Loss: 1.5132
Epoch [23/30], Train Loss: 0.4898, Validation Loss: 1.5393
Epoch [24/30], Train Loss: 0.4613, Validation Loss: 1.5451
Epoch [25/30], Train Loss: 0.4190, Validation Loss: 1.5746
Epoch [26/30], Train Loss: 0.3565, Validation Loss: 1.5977
Epoch [27/30], Train Loss: 0.3328, Validation Loss: 1.6274
Epoch [28/30], Train Loss: 0.2938, Validation Loss: 1.6183
Epoch [29/30], Train Loss: 0.2637, Validation Loss: 1.6283
Epoch [30/30], Train Loss: 0.2695, Validation Loss: 1.6445
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/MT_SUM/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/MT_SUM/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/MT_SUM/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/MT_SUM/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.655, MSE = 0.391
Output 2 (available_P): R^2 Score = 0.791, MSE = 379.884
Output 3 (EC_electric_conductivity): R^2 Score = 0.712, MSE = 0.181
Output 4 (Total_C): R^2 Score = 0.784, MSE = 0.972
Output 5 (Total_N): R^2 Score = 0.650, MSE = 0.095
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9504, Validation Loss: 0.7696
Epoch [2/30], Train Loss: 0.8267, Validation Loss: 0.6755
Epoch [3/30], Train Loss: 0.7099, Validation Loss: 0.5742
Epoch [4/30], Train Loss: 0.5883, Validation Loss: 0.4976
Epoch [5/30], Train Loss: 0.4967, Validation Loss: 0.4392
Epoch [6/30], Train Loss: 0.4183, Validation Loss: 0.4128
Epoch [7/30], Train Loss: 0.3593, Validation Loss: 0.4041
Epoch [8/30], Train Loss: 0.3129, Validation Loss: 0.4072
Epoch [9/30], Train Loss: 0.2615, Validation Loss: 0.4194
Epoch [10/30], Train Loss: 0.2322, Validation Loss: 0.4109
Epoch [11/30], Train Loss: 0.1994, Validation Loss: 0.4326
Epoch [12/30], Train Loss: 0.1742, Validation Loss: 0.4533
Epoch [13/30], Train Loss: 0.1423, Validation Loss: 0.4289
Epoch [14/30], Train Loss: 0.1160, Validation Loss: 0.4290
Epoch [15/30], Train Loss: 0.0986, Validation Loss: 0.4721
Epoch [16/30], Train Loss: 0.0763, Validation Loss: 0.4411
Epoch [17/30], Train Loss: 0.0611, Validation Loss: 0.4551
Epoch [18/30], Train Loss: 0.0518, Validation Loss: 0.4596
Epoch [19/30], Train Loss: 0.0496, Validation Loss: 0.4811
Epoch [20/30], Train Loss: 0.0357, Validation Loss: 0.4461
Epoch [21/30], Train Loss: 0.0295, Validation Loss: 0.5142
Epoch [22/30], Train Loss: 0.0215, Validation Loss: 0.4519
Epoch [23/30], Train Loss: 0.0193, Validation Loss: 0.5087
Epoch [24/30], Train Loss: 0.0187, Validation Loss: 0.5277
Epoch [25/30], Train Loss: 0.0122, Validation Loss: 0.4662
Epoch [26/30], Train Loss: 0.0186, Validation Loss: 0.5170
Epoch [27/30], Train Loss: 0.0113, Validation Loss: 0.5034
Epoch [28/30], Train Loss: 0.0085, Validation Loss: 0.4760
Epoch [29/30], Train Loss: 0.0116, Validation Loss: 0.5412
Epoch [30/30], Train Loss: 0.0139, Validation Loss: 0.4792
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.653, MSE = 0.389
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.083717 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407196
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold1
RF：
決定係数：0.7106290791962171
MAE：0.3413332785011524
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
XGB：
決定係数：0.6854575307044638
MAE：0.3523639440536499
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
LGB：
決定係数：0.6791710530901349
MAE：0.36336123789245606
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9408, Validation Loss: 0.8635
Epoch [2/30], Train Loss: 0.7952, Validation Loss: 0.7258
Epoch [3/30], Train Loss: 0.6762, Validation Loss: 0.5892
Epoch [4/30], Train Loss: 0.5720, Validation Loss: 0.4970
Epoch [5/30], Train Loss: 0.4761, Validation Loss: 0.4385
Epoch [6/30], Train Loss: 0.3728, Validation Loss: 0.3705
Epoch [7/30], Train Loss: 0.3025, Validation Loss: 0.3168
Epoch [8/30], Train Loss: 0.2504, Validation Loss: 0.2946
Epoch [9/30], Train Loss: 0.2093, Validation Loss: 0.2815
Epoch [10/30], Train Loss: 0.1725, Validation Loss: 0.2845
Epoch [11/30], Train Loss: 0.1441, Validation Loss: 0.2892
Epoch [12/30], Train Loss: 0.1155, Validation Loss: 0.2779
Epoch [13/30], Train Loss: 0.1033, Validation Loss: 0.2737
Epoch [14/30], Train Loss: 0.0752, Validation Loss: 0.2837
Epoch [15/30], Train Loss: 0.0778, Validation Loss: 0.2875
Epoch [16/30], Train Loss: 0.0512, Validation Loss: 0.2743
Epoch [17/30], Train Loss: 0.0440, Validation Loss: 0.2915
Epoch [18/30], Train Loss: 0.0310, Validation Loss: 0.2944
Epoch [19/30], Train Loss: 0.0279, Validation Loss: 0.2858
Epoch [20/30], Train Loss: 0.0274, Validation Loss: 0.2823
Epoch [21/30], Train Loss: 0.0267, Validation Loss: 0.2844
Epoch [22/30], Train Loss: 0.0164, Validation Loss: 0.2988
Epoch [23/30], Train Loss: 0.0140, Validation Loss: 0.2926
Epoch [24/30], Train Loss: 0.0105, Validation Loss: 0.2884
Epoch [25/30], Train Loss: 0.0119, Validation Loss: 0.2881
Epoch [26/30], Train Loss: 0.0130, Validation Loss: 0.2852
Epoch [27/30], Train Loss: 0.0087, Validation Loss: 0.2930
Epoch [28/30], Train Loss: 0.0128, Validation Loss: 0.2815
Epoch [29/30], Train Loss: 0.0117, Validation Loss: 0.2905
Epoch [30/30], Train Loss: 0.0087, Validation Loss: 0.2881
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (available_P): R^2 Score = 0.805, MSE = 351.193
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.088776 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407196
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold1
RF：
決定係数：0.7202231997140895
MAE：435.24166387114724
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
XGB：
決定係数：0.7302001868372642
MAE：408.8432922363281
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
LGB：
決定係数：0.7606752220861766
MAE：397.1736026075161
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9553, Validation Loss: 0.4615
Epoch [2/30], Train Loss: 0.7963, Validation Loss: 0.3683
Epoch [3/30], Train Loss: 0.6665, Validation Loss: 0.3017
Epoch [4/30], Train Loss: 0.5522, Validation Loss: 0.2679
Epoch [5/30], Train Loss: 0.4769, Validation Loss: 0.2588
Epoch [6/30], Train Loss: 0.4399, Validation Loss: 0.2540
Epoch [7/30], Train Loss: 0.3807, Validation Loss: 0.2393
Epoch [8/30], Train Loss: 0.3306, Validation Loss: 0.2370
Epoch [9/30], Train Loss: 0.2892, Validation Loss: 0.2310
Epoch [10/30], Train Loss: 0.2487, Validation Loss: 0.2352
Epoch [11/30], Train Loss: 0.2133, Validation Loss: 0.2351
Epoch [12/30], Train Loss: 0.1843, Validation Loss: 0.2443
Epoch [13/30], Train Loss: 0.1549, Validation Loss: 0.2534
Epoch [14/30], Train Loss: 0.1296, Validation Loss: 0.2481
Epoch [15/30], Train Loss: 0.1080, Validation Loss: 0.2492
Epoch [16/30], Train Loss: 0.1025, Validation Loss: 0.2680
Epoch [17/30], Train Loss: 0.0803, Validation Loss: 0.2547
Epoch [18/30], Train Loss: 0.0644, Validation Loss: 0.2615
Epoch [19/30], Train Loss: 0.0488, Validation Loss: 0.2660
Epoch [20/30], Train Loss: 0.0439, Validation Loss: 0.2640
Epoch [21/30], Train Loss: 0.0315, Validation Loss: 0.2713
Epoch [22/30], Train Loss: 0.0271, Validation Loss: 0.2756
Epoch [23/30], Train Loss: 0.0201, Validation Loss: 0.2793
Epoch [24/30], Train Loss: 0.0238, Validation Loss: 0.2713
Epoch [25/30], Train Loss: 0.0132, Validation Loss: 0.2987
Epoch [26/30], Train Loss: 0.0203, Validation Loss: 0.2744
Epoch [27/30], Train Loss: 0.0147, Validation Loss: 0.2819
Epoch [28/30], Train Loss: 0.0130, Validation Loss: 0.3195
Epoch [29/30], Train Loss: 0.0106, Validation Loss: 0.2721
Epoch [30/30], Train Loss: 0.0135, Validation Loss: 0.2778
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (EC_electric_conductivity): R^2 Score = 0.737, MSE = 0.163
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.091150 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407196
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold1
RF：
決定係数：0.6717639567622469
MAE：0.16476299226663216
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
XGB：
決定係数：0.6623056178942495
MAE：0.16463704407215118
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
LGB：
決定係数：0.6869768533217362
MAE：0.17138580118776078
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9939, Validation Loss: 0.8742
Epoch [2/30], Train Loss: 0.9051, Validation Loss: 0.8141
Epoch [3/30], Train Loss: 0.8246, Validation Loss: 0.7529
Epoch [4/30], Train Loss: 0.7549, Validation Loss: 0.6858
Epoch [5/30], Train Loss: 0.6672, Validation Loss: 0.6225
Epoch [6/30], Train Loss: 0.5726, Validation Loss: 0.5518
Epoch [7/30], Train Loss: 0.4654, Validation Loss: 0.4671
Epoch [8/30], Train Loss: 0.3801, Validation Loss: 0.3915
Epoch [9/30], Train Loss: 0.2971, Validation Loss: 0.3361
Epoch [10/30], Train Loss: 0.2393, Validation Loss: 0.3048
Epoch [11/30], Train Loss: 0.1924, Validation Loss: 0.2860
Epoch [12/30], Train Loss: 0.1549, Validation Loss: 0.2781
Epoch [13/30], Train Loss: 0.1298, Validation Loss: 0.2787
Epoch [14/30], Train Loss: 0.0990, Validation Loss: 0.2766
Epoch [15/30], Train Loss: 0.0865, Validation Loss: 0.2845
Epoch [16/30], Train Loss: 0.0650, Validation Loss: 0.2844
Epoch [17/30], Train Loss: 0.0484, Validation Loss: 0.2900
Epoch [18/30], Train Loss: 0.0388, Validation Loss: 0.3031
Epoch [19/30], Train Loss: 0.0298, Validation Loss: 0.3124
Epoch [20/30], Train Loss: 0.0229, Validation Loss: 0.3024
Epoch [21/30], Train Loss: 0.0211, Validation Loss: 0.2999
Epoch [22/30], Train Loss: 0.0134, Validation Loss: 0.3027
Epoch [23/30], Train Loss: 0.0206, Validation Loss: 0.3074
Epoch [24/30], Train Loss: 0.0169, Validation Loss: 0.3195
Epoch [25/30], Train Loss: 0.0151, Validation Loss: 0.3287
Epoch [26/30], Train Loss: 0.0137, Validation Loss: 0.3218
Epoch [27/30], Train Loss: 0.0089, Validation Loss: 0.3066
Epoch [28/30], Train Loss: 0.0094, Validation Loss: 0.3049
Epoch [29/30], Train Loss: 0.0190, Validation Loss: 0.3042
Epoch [30/30], Train Loss: 0.0078, Validation Loss: 0.3105
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_C): R^2 Score = 0.811, MSE = 0.935
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.094443 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407196
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold1
RF：
決定係数：0.8017166960238847
MAE：0.8925930157842085
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
XGB：
決定係数：0.7622558595745624
MAE：0.8939295411109924
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
LGB：
決定係数：0.7982123982075909
MAE：0.8789353377513759
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9749, Validation Loss: 0.4158
Epoch [2/30], Train Loss: 0.8970, Validation Loss: 0.3775
Epoch [3/30], Train Loss: 0.8095, Validation Loss: 0.3372
Epoch [4/30], Train Loss: 0.7630, Validation Loss: 0.2987
Epoch [5/30], Train Loss: 0.6793, Validation Loss: 0.2658
Epoch [6/30], Train Loss: 0.6287, Validation Loss: 0.2342
Epoch [7/30], Train Loss: 0.5500, Validation Loss: 0.2091
Epoch [8/30], Train Loss: 0.4828, Validation Loss: 0.1887
Epoch [9/30], Train Loss: 0.4401, Validation Loss: 0.1821
Epoch [10/30], Train Loss: 0.3905, Validation Loss: 0.1761
Epoch [11/30], Train Loss: 0.3285, Validation Loss: 0.1800
Epoch [12/30], Train Loss: 0.2877, Validation Loss: 0.1829
Epoch [13/30], Train Loss: 0.2342, Validation Loss: 0.1910
Epoch [14/30], Train Loss: 0.2098, Validation Loss: 0.1972
Epoch [15/30], Train Loss: 0.1783, Validation Loss: 0.1998
Epoch [16/30], Train Loss: 0.1362, Validation Loss: 0.2028
Epoch [17/30], Train Loss: 0.1244, Validation Loss: 0.2262
Epoch [18/30], Train Loss: 0.1229, Validation Loss: 0.2126
Epoch [19/30], Train Loss: 0.0865, Validation Loss: 0.2236
Epoch [20/30], Train Loss: 0.0764, Validation Loss: 0.2310
Epoch [21/30], Train Loss: 0.0761, Validation Loss: 0.2237
Epoch [22/30], Train Loss: 0.0714, Validation Loss: 0.2221
Epoch [23/30], Train Loss: 0.0652, Validation Loss: 0.2549
Epoch [24/30], Train Loss: 0.0676, Validation Loss: 0.2267
Epoch [25/30], Train Loss: 0.0437, Validation Loss: 0.2326
Epoch [26/30], Train Loss: 0.0433, Validation Loss: 0.2559
Epoch [27/30], Train Loss: 0.0310, Validation Loss: 0.2344
Epoch [28/30], Train Loss: 0.0319, Validation Loss: 0.2694
Epoch [29/30], Train Loss: 0.0331, Validation Loss: 0.2541
Epoch [30/30], Train Loss: 0.0294, Validation Loss: 0.2619
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_N): R^2 Score = 0.640, MSE = 0.093
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.092527 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407196
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold1
RF：
決定係数：0.4923840269585678
MAE：0.0791599968515383
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/RF/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
XGB：
決定係数：0.702940541770051
MAE：0.07295610010623932
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/XGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold1
LGB：
決定係数：0.5573007253031289
MAE：0.08178893171105613
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold1/LGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1128, 1597)
特徴選択後：(1128, 1597)
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 4.8933, Validation Loss: 4.0872
Epoch [2/30], Train Loss: 4.5355, Validation Loss: 3.7807
Epoch [3/30], Train Loss: 4.2122, Validation Loss: 3.4396
Epoch [4/30], Train Loss: 3.8885, Validation Loss: 3.1266
Epoch [5/30], Train Loss: 3.5813, Validation Loss: 2.8715
Epoch [6/30], Train Loss: 3.2169, Validation Loss: 2.6779
Epoch [7/30], Train Loss: 2.9066, Validation Loss: 2.5008
Epoch [8/30], Train Loss: 2.6092, Validation Loss: 2.3002
Epoch [9/30], Train Loss: 2.3021, Validation Loss: 2.1200
Epoch [10/30], Train Loss: 2.0123, Validation Loss: 1.9483
Epoch [11/30], Train Loss: 1.7927, Validation Loss: 1.8311
Epoch [12/30], Train Loss: 1.5600, Validation Loss: 1.7541
Epoch [13/30], Train Loss: 1.3812, Validation Loss: 1.6928
Epoch [14/30], Train Loss: 1.2877, Validation Loss: 1.6508
Epoch [15/30], Train Loss: 1.1342, Validation Loss: 1.6454
Epoch [16/30], Train Loss: 0.9927, Validation Loss: 1.6370
Epoch [17/30], Train Loss: 0.8988, Validation Loss: 1.6326
Epoch [18/30], Train Loss: 0.7897, Validation Loss: 1.6412
Epoch [19/30], Train Loss: 0.7064, Validation Loss: 1.6429
Epoch [20/30], Train Loss: 0.6333, Validation Loss: 1.6636
Epoch [21/30], Train Loss: 0.5461, Validation Loss: 1.6813
Epoch [22/30], Train Loss: 0.4781, Validation Loss: 1.6966
Epoch [23/30], Train Loss: 0.4243, Validation Loss: 1.7137
Epoch [24/30], Train Loss: 0.3706, Validation Loss: 1.7421
Epoch [25/30], Train Loss: 0.3190, Validation Loss: 1.7583
Epoch [26/30], Train Loss: 0.2884, Validation Loss: 1.7769
Epoch [27/30], Train Loss: 0.2459, Validation Loss: 1.8083
Epoch [28/30], Train Loss: 0.2192, Validation Loss: 1.8319
Epoch [29/30], Train Loss: 0.2269, Validation Loss: 1.8443
Epoch [30/30], Train Loss: 0.1839, Validation Loss: 1.8685
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/MT/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/MT/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/MT/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/MT/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.698, MSE = 0.357
Output 2 (available_P): R^2 Score = 0.751, MSE = 408.271
Output 3 (EC_electric_conductivity): R^2 Score = 0.751, MSE = 0.176
Output 4 (Total_C): R^2 Score = 0.736, MSE = 0.888
Output 5 (Total_N): R^2 Score = 0.505, MSE = 0.085
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 4.9514, Validation Loss: 4.1680
Epoch [2/30], Train Loss: 4.5991, Validation Loss: 3.8935
Epoch [3/30], Train Loss: 4.3308, Validation Loss: 3.5733
Epoch [4/30], Train Loss: 4.0049, Validation Loss: 3.2539
Epoch [5/30], Train Loss: 3.6939, Validation Loss: 2.9677
Epoch [6/30], Train Loss: 3.3003, Validation Loss: 2.7214
Epoch [7/30], Train Loss: 2.9713, Validation Loss: 2.5178
Epoch [8/30], Train Loss: 2.6762, Validation Loss: 2.3381
Epoch [9/30], Train Loss: 2.3775, Validation Loss: 2.1586
Epoch [10/30], Train Loss: 2.0670, Validation Loss: 2.0013
Epoch [11/30], Train Loss: 1.8638, Validation Loss: 1.8637
Epoch [12/30], Train Loss: 1.6228, Validation Loss: 1.7812
Epoch [13/30], Train Loss: 1.4694, Validation Loss: 1.7318
Epoch [14/30], Train Loss: 1.2971, Validation Loss: 1.6869
Epoch [15/30], Train Loss: 1.1770, Validation Loss: 1.6719
Epoch [16/30], Train Loss: 1.0503, Validation Loss: 1.6671
Epoch [17/30], Train Loss: 0.9129, Validation Loss: 1.6777
Epoch [18/30], Train Loss: 0.8165, Validation Loss: 1.6869
Epoch [19/30], Train Loss: 0.7280, Validation Loss: 1.7066
Epoch [20/30], Train Loss: 0.6396, Validation Loss: 1.7124
Epoch [21/30], Train Loss: 0.5758, Validation Loss: 1.7378
Epoch [22/30], Train Loss: 0.5100, Validation Loss: 1.7567
Epoch [23/30], Train Loss: 0.4534, Validation Loss: 1.7880
Epoch [24/30], Train Loss: 0.4012, Validation Loss: 1.7898
Epoch [25/30], Train Loss: 0.3445, Validation Loss: 1.8183
Epoch [26/30], Train Loss: 0.3088, Validation Loss: 1.8265
Epoch [27/30], Train Loss: 0.2954, Validation Loss: 1.8643
Epoch [28/30], Train Loss: 0.2566, Validation Loss: 1.8584
Epoch [29/30], Train Loss: 0.2530, Validation Loss: 1.9225
Epoch [30/30], Train Loss: 0.1946, Validation Loss: 1.8846
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/MT_SUM/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/MT_SUM/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/MT_SUM/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/MT_SUM/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.685, MSE = 0.351
Output 2 (available_P): R^2 Score = 0.746, MSE = 434.161
Output 3 (EC_electric_conductivity): R^2 Score = 0.739, MSE = 0.171
Output 4 (Total_C): R^2 Score = 0.764, MSE = 0.873
Output 5 (Total_N): R^2 Score = 0.517, MSE = 0.085
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9573, Validation Loss: 0.9515
Epoch [2/30], Train Loss: 0.8440, Validation Loss: 0.8387
Epoch [3/30], Train Loss: 0.7320, Validation Loss: 0.7156
Epoch [4/30], Train Loss: 0.6286, Validation Loss: 0.6181
Epoch [5/30], Train Loss: 0.5470, Validation Loss: 0.5561
Epoch [6/30], Train Loss: 0.4797, Validation Loss: 0.5173
Epoch [7/30], Train Loss: 0.4203, Validation Loss: 0.4978
Epoch [8/30], Train Loss: 0.3705, Validation Loss: 0.4844
Epoch [9/30], Train Loss: 0.3187, Validation Loss: 0.4731
Epoch [10/30], Train Loss: 0.2733, Validation Loss: 0.4585
Epoch [11/30], Train Loss: 0.2354, Validation Loss: 0.4588
Epoch [12/30], Train Loss: 0.2034, Validation Loss: 0.4744
Epoch [13/30], Train Loss: 0.1671, Validation Loss: 0.4821
Epoch [14/30], Train Loss: 0.1344, Validation Loss: 0.4919
Epoch [15/30], Train Loss: 0.1128, Validation Loss: 0.5046
Epoch [16/30], Train Loss: 0.0859, Validation Loss: 0.5005
Epoch [17/30], Train Loss: 0.0717, Validation Loss: 0.5310
Epoch [18/30], Train Loss: 0.0573, Validation Loss: 0.5192
Epoch [19/30], Train Loss: 0.0474, Validation Loss: 0.5366
Epoch [20/30], Train Loss: 0.0392, Validation Loss: 0.5295
Epoch [21/30], Train Loss: 0.0282, Validation Loss: 0.5518
Epoch [22/30], Train Loss: 0.0226, Validation Loss: 0.5491
Epoch [23/30], Train Loss: 0.0227, Validation Loss: 0.5470
Epoch [24/30], Train Loss: 0.0168, Validation Loss: 0.5972
Epoch [25/30], Train Loss: 0.0130, Validation Loss: 0.5558
Epoch [26/30], Train Loss: 0.0120, Validation Loss: 0.5655
Epoch [27/30], Train Loss: 0.0134, Validation Loss: 0.5586
Epoch [28/30], Train Loss: 0.0087, Validation Loss: 0.5670
Epoch [29/30], Train Loss: 0.0089, Validation Loss: 0.5687
Epoch [30/30], Train Loss: 0.0096, Validation Loss: 0.5923
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.691, MSE = 0.350
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.068456 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407197
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold2
RF：
決定係数：0.7485986441027227
MAE：0.31775211826907973
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
XGB：
決定係数：0.6960007491628298
MAE：0.3415268063545227
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
LGB：
決定係数：0.7343040694654838
MAE：0.31863609072439136
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9506, Validation Loss: 0.9362
Epoch [2/30], Train Loss: 0.8362, Validation Loss: 0.7797
Epoch [3/30], Train Loss: 0.7091, Validation Loss: 0.6295
Epoch [4/30], Train Loss: 0.6013, Validation Loss: 0.5398
Epoch [5/30], Train Loss: 0.4734, Validation Loss: 0.5038
Epoch [6/30], Train Loss: 0.3911, Validation Loss: 0.4659
Epoch [7/30], Train Loss: 0.2964, Validation Loss: 0.3879
Epoch [8/30], Train Loss: 0.2292, Validation Loss: 0.3609
Epoch [9/30], Train Loss: 0.2016, Validation Loss: 0.3444
Epoch [10/30], Train Loss: 0.1551, Validation Loss: 0.3356
Epoch [11/30], Train Loss: 0.1198, Validation Loss: 0.3323
Epoch [12/30], Train Loss: 0.0986, Validation Loss: 0.3351
Epoch [13/30], Train Loss: 0.0805, Validation Loss: 0.3295
Epoch [14/30], Train Loss: 0.0593, Validation Loss: 0.3326
Epoch [15/30], Train Loss: 0.0520, Validation Loss: 0.3339
Epoch [16/30], Train Loss: 0.0415, Validation Loss: 0.3343
Epoch [17/30], Train Loss: 0.0356, Validation Loss: 0.3397
Epoch [18/30], Train Loss: 0.0253, Validation Loss: 0.3401
Epoch [19/30], Train Loss: 0.0211, Validation Loss: 0.3384
Epoch [20/30], Train Loss: 0.0170, Validation Loss: 0.3408
Epoch [21/30], Train Loss: 0.0175, Validation Loss: 0.3417
Epoch [22/30], Train Loss: 0.0171, Validation Loss: 0.3420
Epoch [23/30], Train Loss: 0.0132, Validation Loss: 0.3462
Epoch [24/30], Train Loss: 0.0092, Validation Loss: 0.3515
Epoch [25/30], Train Loss: 0.0097, Validation Loss: 0.3525
Epoch [26/30], Train Loss: 0.0079, Validation Loss: 0.3515
Epoch [27/30], Train Loss: 0.0112, Validation Loss: 0.3504
Epoch [28/30], Train Loss: 0.0111, Validation Loss: 0.3484
Epoch [29/30], Train Loss: 0.0108, Validation Loss: 0.3470
Epoch [30/30], Train Loss: 0.0081, Validation Loss: 0.3448
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (available_P): R^2 Score = 0.779, MSE = 360.457
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.067201 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407197
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold2
RF：
決定係数：0.6923137958797186
MAE：426.39801974968526
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
XGB：
決定係数：0.677703645624865
MAE：402.62158203125
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
LGB：
決定係数：0.7115087543326158
MAE：422.22927268572636
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9064, Validation Loss: 0.5920
Epoch [2/30], Train Loss: 0.7149, Validation Loss: 0.4523
Epoch [3/30], Train Loss: 0.5805, Validation Loss: 0.3632
Epoch [4/30], Train Loss: 0.4981, Validation Loss: 0.3242
Epoch [5/30], Train Loss: 0.4362, Validation Loss: 0.3054
Epoch [6/30], Train Loss: 0.3891, Validation Loss: 0.2903
Epoch [7/30], Train Loss: 0.3429, Validation Loss: 0.2804
Epoch [8/30], Train Loss: 0.3001, Validation Loss: 0.2713
Epoch [9/30], Train Loss: 0.2531, Validation Loss: 0.2686
Epoch [10/30], Train Loss: 0.2124, Validation Loss: 0.2691
Epoch [11/30], Train Loss: 0.1844, Validation Loss: 0.2763
Epoch [12/30], Train Loss: 0.1617, Validation Loss: 0.2758
Epoch [13/30], Train Loss: 0.1431, Validation Loss: 0.2843
Epoch [14/30], Train Loss: 0.1200, Validation Loss: 0.2825
Epoch [15/30], Train Loss: 0.1098, Validation Loss: 0.3094
Epoch [16/30], Train Loss: 0.0911, Validation Loss: 0.2966
Epoch [17/30], Train Loss: 0.0726, Validation Loss: 0.2887
Epoch [18/30], Train Loss: 0.0583, Validation Loss: 0.2993
Epoch [19/30], Train Loss: 0.0520, Validation Loss: 0.2984
Epoch [20/30], Train Loss: 0.0410, Validation Loss: 0.3018
Epoch [21/30], Train Loss: 0.0342, Validation Loss: 0.3116
Epoch [22/30], Train Loss: 0.0282, Validation Loss: 0.3126
Epoch [23/30], Train Loss: 0.0254, Validation Loss: 0.3137
Epoch [24/30], Train Loss: 0.0164, Validation Loss: 0.3202
Epoch [25/30], Train Loss: 0.0158, Validation Loss: 0.3194
Epoch [26/30], Train Loss: 0.0211, Validation Loss: 0.3417
Epoch [27/30], Train Loss: 0.0148, Validation Loss: 0.3345
Epoch [28/30], Train Loss: 0.0117, Validation Loss: 0.3302
Epoch [29/30], Train Loss: 0.0116, Validation Loss: 0.3227
Epoch [30/30], Train Loss: 0.0085, Validation Loss: 0.3334
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (EC_electric_conductivity): R^2 Score = 0.764, MSE = 0.167
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.074008 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407197
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold2
RF：
決定係数：0.7277929633851382
MAE：0.157812437667552
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
XGB：
決定係数：0.7079162194742938
MAE：0.16077588498592377
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
LGB：
決定係数：0.7231461712352492
MAE：0.1560311675916476
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9691, Validation Loss: 0.7523
Epoch [2/30], Train Loss: 0.8444, Validation Loss: 0.6772
Epoch [3/30], Train Loss: 0.7497, Validation Loss: 0.5996
Epoch [4/30], Train Loss: 0.6507, Validation Loss: 0.5357
Epoch [5/30], Train Loss: 0.5450, Validation Loss: 0.4858
Epoch [6/30], Train Loss: 0.4461, Validation Loss: 0.4266
Epoch [7/30], Train Loss: 0.3490, Validation Loss: 0.3654
Epoch [8/30], Train Loss: 0.2689, Validation Loss: 0.3171
Epoch [9/30], Train Loss: 0.2125, Validation Loss: 0.2793
Epoch [10/30], Train Loss: 0.1752, Validation Loss: 0.2690
Epoch [11/30], Train Loss: 0.1295, Validation Loss: 0.2585
Epoch [12/30], Train Loss: 0.1035, Validation Loss: 0.2579
Epoch [13/30], Train Loss: 0.0789, Validation Loss: 0.2552
Epoch [14/30], Train Loss: 0.0558, Validation Loss: 0.2624
Epoch [15/30], Train Loss: 0.0434, Validation Loss: 0.2597
Epoch [16/30], Train Loss: 0.0333, Validation Loss: 0.2699
Epoch [17/30], Train Loss: 0.0294, Validation Loss: 0.2680
Epoch [18/30], Train Loss: 0.0242, Validation Loss: 0.2876
Epoch [19/30], Train Loss: 0.0158, Validation Loss: 0.2702
Epoch [20/30], Train Loss: 0.0115, Validation Loss: 0.2841
Epoch [21/30], Train Loss: 0.0133, Validation Loss: 0.2690
Epoch [22/30], Train Loss: 0.0163, Validation Loss: 0.2743
Epoch [23/30], Train Loss: 0.0105, Validation Loss: 0.2762
Epoch [24/30], Train Loss: 0.0096, Validation Loss: 0.2735
Epoch [25/30], Train Loss: 0.0088, Validation Loss: 0.2740
Epoch [26/30], Train Loss: 0.0074, Validation Loss: 0.2763
Epoch [27/30], Train Loss: 0.0050, Validation Loss: 0.2735
Epoch [28/30], Train Loss: 0.0059, Validation Loss: 0.2767
Epoch [29/30], Train Loss: 0.0064, Validation Loss: 0.2706
Epoch [30/30], Train Loss: 0.0142, Validation Loss: 0.2700
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_C): R^2 Score = 0.757, MSE = 0.801
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.090819 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407197
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold2
RF：
決定係数：0.7288409944038559
MAE：0.8646585128887134
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
XGB：
決定係数：0.7317097506927063
MAE：0.8795515298843384
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
LGB：
決定係数：0.730049195461547
MAE：0.8689636956962076
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9689, Validation Loss: 0.5754
Epoch [2/30], Train Loss: 0.8743, Validation Loss: 0.5262
Epoch [3/30], Train Loss: 0.7964, Validation Loss: 0.4768
Epoch [4/30], Train Loss: 0.7400, Validation Loss: 0.4416
Epoch [5/30], Train Loss: 0.6453, Validation Loss: 0.4051
Epoch [6/30], Train Loss: 0.5758, Validation Loss: 0.3655
Epoch [7/30], Train Loss: 0.5021, Validation Loss: 0.3279
Epoch [8/30], Train Loss: 0.4533, Validation Loss: 0.3079
Epoch [9/30], Train Loss: 0.3748, Validation Loss: 0.2693
Epoch [10/30], Train Loss: 0.3431, Validation Loss: 0.2649
Epoch [11/30], Train Loss: 0.2756, Validation Loss: 0.2525
Epoch [12/30], Train Loss: 0.2289, Validation Loss: 0.2527
Epoch [13/30], Train Loss: 0.1847, Validation Loss: 0.2517
Epoch [14/30], Train Loss: 0.1376, Validation Loss: 0.2542
Epoch [15/30], Train Loss: 0.1019, Validation Loss: 0.2594
Epoch [16/30], Train Loss: 0.0833, Validation Loss: 0.2758
Epoch [17/30], Train Loss: 0.0542, Validation Loss: 0.2829
Epoch [18/30], Train Loss: 0.0414, Validation Loss: 0.2880
Epoch [19/30], Train Loss: 0.0309, Validation Loss: 0.2787
Epoch [20/30], Train Loss: 0.0276, Validation Loss: 0.2856
Epoch [21/30], Train Loss: 0.0229, Validation Loss: 0.2875
Epoch [22/30], Train Loss: 0.0232, Validation Loss: 0.2910
Epoch [23/30], Train Loss: 0.0240, Validation Loss: 0.2836
Epoch [24/30], Train Loss: 0.0160, Validation Loss: 0.2743
Epoch [25/30], Train Loss: 0.0141, Validation Loss: 0.2884
Epoch [26/30], Train Loss: 0.0083, Validation Loss: 0.2794
Epoch [27/30], Train Loss: 0.0193, Validation Loss: 0.2750
Epoch [28/30], Train Loss: 0.0105, Validation Loss: 0.2765
Epoch [29/30], Train Loss: 0.0124, Validation Loss: 0.2784
Epoch [30/30], Train Loss: 0.0123, Validation Loss: 0.2787
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_N): R^2 Score = 0.555, MSE = 0.085
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.053537 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407197
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold2
RF：
決定係数：0.3151865307627667
MAE：0.08493041322132437
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/RF/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
XGB：
決定係数：0.4999943987578428
MAE：0.08029954880475998
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/XGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold2
LGB：
決定係数：0.5081807177907468
MAE：0.08156913292408036
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold2/LGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1128, 1597)
特徴選択後：(1128, 1597)
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 4.9123, Validation Loss: 5.1937
Epoch [2/30], Train Loss: 4.6393, Validation Loss: 4.9337
Epoch [3/30], Train Loss: 4.3601, Validation Loss: 4.6591
Epoch [4/30], Train Loss: 4.0720, Validation Loss: 4.3750
Epoch [5/30], Train Loss: 3.7753, Validation Loss: 4.0888
Epoch [6/30], Train Loss: 3.4574, Validation Loss: 3.8073
Epoch [7/30], Train Loss: 3.1600, Validation Loss: 3.5466
Epoch [8/30], Train Loss: 2.8937, Validation Loss: 3.2908
Epoch [9/30], Train Loss: 2.5778, Validation Loss: 3.0926
Epoch [10/30], Train Loss: 2.2808, Validation Loss: 2.8323
Epoch [11/30], Train Loss: 2.0403, Validation Loss: 2.6389
Epoch [12/30], Train Loss: 1.8082, Validation Loss: 2.4998
Epoch [13/30], Train Loss: 1.6112, Validation Loss: 2.3758
Epoch [14/30], Train Loss: 1.4233, Validation Loss: 2.3087
Epoch [15/30], Train Loss: 1.2696, Validation Loss: 2.2676
Epoch [16/30], Train Loss: 1.1230, Validation Loss: 2.2213
Epoch [17/30], Train Loss: 1.0075, Validation Loss: 2.2279
Epoch [18/30], Train Loss: 0.9008, Validation Loss: 2.2228
Epoch [19/30], Train Loss: 0.8041, Validation Loss: 2.2141
Epoch [20/30], Train Loss: 0.7296, Validation Loss: 2.2103
Epoch [21/30], Train Loss: 0.6541, Validation Loss: 2.2414
Epoch [22/30], Train Loss: 0.5827, Validation Loss: 2.2290
Epoch [23/30], Train Loss: 0.5036, Validation Loss: 2.2665
Epoch [24/30], Train Loss: 0.4567, Validation Loss: 2.2566
Epoch [25/30], Train Loss: 0.3822, Validation Loss: 2.2812
Epoch [26/30], Train Loss: 0.3659, Validation Loss: 2.2768
Epoch [27/30], Train Loss: 0.3180, Validation Loss: 2.2672
Epoch [28/30], Train Loss: 0.2749, Validation Loss: 2.2874
Epoch [29/30], Train Loss: 0.2665, Validation Loss: 2.3674
Epoch [30/30], Train Loss: 0.2317, Validation Loss: 2.2994
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/MT/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/MT/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/MT/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/MT/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.683, MSE = 0.367
Output 2 (available_P): R^2 Score = 0.801, MSE = 390.079
Output 3 (EC_electric_conductivity): R^2 Score = 0.743, MSE = 0.163
Output 4 (Total_C): R^2 Score = 0.760, MSE = 0.983
Output 5 (Total_N): R^2 Score = 0.567, MSE = 0.082
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 4.9581, Validation Loss: 5.2024
Epoch [2/30], Train Loss: 4.6133, Validation Loss: 4.9136
Epoch [3/30], Train Loss: 4.2992, Validation Loss: 4.5892
Epoch [4/30], Train Loss: 3.9804, Validation Loss: 4.2518
Epoch [5/30], Train Loss: 3.6836, Validation Loss: 3.9477
Epoch [6/30], Train Loss: 3.3423, Validation Loss: 3.6497
Epoch [7/30], Train Loss: 3.0033, Validation Loss: 3.3959
Epoch [8/30], Train Loss: 2.7790, Validation Loss: 3.1487
Epoch [9/30], Train Loss: 2.4419, Validation Loss: 2.8890
Epoch [10/30], Train Loss: 2.1704, Validation Loss: 2.6924
Epoch [11/30], Train Loss: 1.9455, Validation Loss: 2.5396
Epoch [12/30], Train Loss: 1.7286, Validation Loss: 2.3997
Epoch [13/30], Train Loss: 1.5316, Validation Loss: 2.3165
Epoch [14/30], Train Loss: 1.3971, Validation Loss: 2.2481
Epoch [15/30], Train Loss: 1.2261, Validation Loss: 2.2156
Epoch [16/30], Train Loss: 1.1234, Validation Loss: 2.2012
Epoch [17/30], Train Loss: 1.0267, Validation Loss: 2.2076
Epoch [18/30], Train Loss: 0.9387, Validation Loss: 2.2116
Epoch [19/30], Train Loss: 0.8183, Validation Loss: 2.2244
Epoch [20/30], Train Loss: 0.7383, Validation Loss: 2.2165
Epoch [21/30], Train Loss: 0.6585, Validation Loss: 2.2284
Epoch [22/30], Train Loss: 0.5946, Validation Loss: 2.2638
Epoch [23/30], Train Loss: 0.5331, Validation Loss: 2.2800
Epoch [24/30], Train Loss: 0.5104, Validation Loss: 2.2807
Epoch [25/30], Train Loss: 0.4710, Validation Loss: 2.3296
Epoch [26/30], Train Loss: 0.4170, Validation Loss: 2.3217
Epoch [27/30], Train Loss: 0.3755, Validation Loss: 2.3480
Epoch [28/30], Train Loss: 0.3552, Validation Loss: 2.3700
Epoch [29/30], Train Loss: 0.3017, Validation Loss: 2.3348
Epoch [30/30], Train Loss: 0.3064, Validation Loss: 2.3360
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/MT_SUM/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/MT_SUM/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/MT_SUM/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/MT_SUM/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.693, MSE = 0.367
Output 2 (available_P): R^2 Score = 0.818, MSE = 388.657
Output 3 (EC_electric_conductivity): R^2 Score = 0.777, MSE = 0.158
Output 4 (Total_C): R^2 Score = 0.777, MSE = 0.936
Output 5 (Total_N): R^2 Score = 0.590, MSE = 0.080
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9406, Validation Loss: 1.0667
Epoch [2/30], Train Loss: 0.8122, Validation Loss: 0.9363
Epoch [3/30], Train Loss: 0.6938, Validation Loss: 0.8061
Epoch [4/30], Train Loss: 0.5867, Validation Loss: 0.6897
Epoch [5/30], Train Loss: 0.5068, Validation Loss: 0.6122
Epoch [6/30], Train Loss: 0.4306, Validation Loss: 0.5546
Epoch [7/30], Train Loss: 0.3813, Validation Loss: 0.5177
Epoch [8/30], Train Loss: 0.3313, Validation Loss: 0.5034
Epoch [9/30], Train Loss: 0.2893, Validation Loss: 0.4863
Epoch [10/30], Train Loss: 0.2454, Validation Loss: 0.4771
Epoch [11/30], Train Loss: 0.2178, Validation Loss: 0.4699
Epoch [12/30], Train Loss: 0.1856, Validation Loss: 0.4914
Epoch [13/30], Train Loss: 0.1596, Validation Loss: 0.4614
Epoch [14/30], Train Loss: 0.1290, Validation Loss: 0.4842
Epoch [15/30], Train Loss: 0.1071, Validation Loss: 0.4809
Epoch [16/30], Train Loss: 0.0849, Validation Loss: 0.4894
Epoch [17/30], Train Loss: 0.0704, Validation Loss: 0.4952
Epoch [18/30], Train Loss: 0.0561, Validation Loss: 0.5031
Epoch [19/30], Train Loss: 0.0490, Validation Loss: 0.5258
Epoch [20/30], Train Loss: 0.0363, Validation Loss: 0.5034
Epoch [21/30], Train Loss: 0.0323, Validation Loss: 0.5395
Epoch [22/30], Train Loss: 0.0284, Validation Loss: 0.5138
Epoch [23/30], Train Loss: 0.0225, Validation Loss: 0.5534
Epoch [24/30], Train Loss: 0.0191, Validation Loss: 0.5211
Epoch [25/30], Train Loss: 0.0153, Validation Loss: 0.5671
Epoch [26/30], Train Loss: 0.0186, Validation Loss: 0.5339
Epoch [27/30], Train Loss: 0.0186, Validation Loss: 0.5327
Epoch [28/30], Train Loss: 0.0140, Validation Loss: 0.5680
Epoch [29/30], Train Loss: 0.0152, Validation Loss: 0.5357
Epoch [30/30], Train Loss: 0.0099, Validation Loss: 0.5644
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.695, MSE = 0.376
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.055489 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407189
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold3
RF：
決定係数：0.7630892964130854
MAE：0.3286227817496536
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
XGB：
決定係数：0.7110826903389673
MAE：0.35289397835731506
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
LGB：
決定係数：0.7290619355671395
MAE：0.3401131693449695
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9576, Validation Loss: 0.7897
Epoch [2/30], Train Loss: 0.8638, Validation Loss: 0.7103
Epoch [3/30], Train Loss: 0.7737, Validation Loss: 0.6217
Epoch [4/30], Train Loss: 0.6718, Validation Loss: 0.5375
Epoch [5/30], Train Loss: 0.5708, Validation Loss: 0.4722
Epoch [6/30], Train Loss: 0.4657, Validation Loss: 0.4044
Epoch [7/30], Train Loss: 0.3736, Validation Loss: 0.3398
Epoch [8/30], Train Loss: 0.3006, Validation Loss: 0.3013
Epoch [9/30], Train Loss: 0.2494, Validation Loss: 0.2774
Epoch [10/30], Train Loss: 0.2071, Validation Loss: 0.2734
Epoch [11/30], Train Loss: 0.1673, Validation Loss: 0.2754
Epoch [12/30], Train Loss: 0.1377, Validation Loss: 0.2525
Epoch [13/30], Train Loss: 0.1116, Validation Loss: 0.2520
Epoch [14/30], Train Loss: 0.1024, Validation Loss: 0.2558
Epoch [15/30], Train Loss: 0.0750, Validation Loss: 0.2542
Epoch [16/30], Train Loss: 0.0587, Validation Loss: 0.2647
Epoch [17/30], Train Loss: 0.0458, Validation Loss: 0.2771
Epoch [18/30], Train Loss: 0.0380, Validation Loss: 0.2714
Epoch [19/30], Train Loss: 0.0302, Validation Loss: 0.2782
Epoch [20/30], Train Loss: 0.0238, Validation Loss: 0.2794
Epoch [21/30], Train Loss: 0.0210, Validation Loss: 0.2778
Epoch [22/30], Train Loss: 0.0247, Validation Loss: 0.2886
Epoch [23/30], Train Loss: 0.0137, Validation Loss: 0.2803
Epoch [24/30], Train Loss: 0.0143, Validation Loss: 0.2915
Epoch [25/30], Train Loss: 0.0147, Validation Loss: 0.2858
Epoch [26/30], Train Loss: 0.0111, Validation Loss: 0.2958
Epoch [27/30], Train Loss: 0.0136, Validation Loss: 0.2883
Epoch [28/30], Train Loss: 0.0093, Validation Loss: 0.2839
Epoch [29/30], Train Loss: 0.0083, Validation Loss: 0.2916
Epoch [30/30], Train Loss: 0.0081, Validation Loss: 0.2918
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (available_P): R^2 Score = 0.825, MSE = 345.473
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.091127 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407189
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold3
RF：
決定係数：0.8053676187665223
MAE：391.8679276495465
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
XGB：
決定係数：0.7753366589174782
MAE：381.52105712890625
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
LGB：
決定係数：0.7973016358144454
MAE：389.491857832899
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9512, Validation Loss: 0.7658
Epoch [2/30], Train Loss: 0.8261, Validation Loss: 0.6584
Epoch [3/30], Train Loss: 0.7126, Validation Loss: 0.5565
Epoch [4/30], Train Loss: 0.6002, Validation Loss: 0.4784
Epoch [5/30], Train Loss: 0.5274, Validation Loss: 0.4279
Epoch [6/30], Train Loss: 0.4813, Validation Loss: 0.3913
Epoch [7/30], Train Loss: 0.4203, Validation Loss: 0.3621
Epoch [8/30], Train Loss: 0.3735, Validation Loss: 0.3328
Epoch [9/30], Train Loss: 0.3315, Validation Loss: 0.3070
Epoch [10/30], Train Loss: 0.2849, Validation Loss: 0.2802
Epoch [11/30], Train Loss: 0.2510, Validation Loss: 0.2638
Epoch [12/30], Train Loss: 0.2060, Validation Loss: 0.2571
Epoch [13/30], Train Loss: 0.1763, Validation Loss: 0.2665
Epoch [14/30], Train Loss: 0.1474, Validation Loss: 0.2667
Epoch [15/30], Train Loss: 0.1230, Validation Loss: 0.2967
Epoch [16/30], Train Loss: 0.1106, Validation Loss: 0.2854
Epoch [17/30], Train Loss: 0.0849, Validation Loss: 0.3061
Epoch [18/30], Train Loss: 0.0711, Validation Loss: 0.3327
Epoch [19/30], Train Loss: 0.0574, Validation Loss: 0.3364
Epoch [20/30], Train Loss: 0.0429, Validation Loss: 0.3280
Epoch [21/30], Train Loss: 0.0356, Validation Loss: 0.3569
Epoch [22/30], Train Loss: 0.0341, Validation Loss: 0.3561
Epoch [23/30], Train Loss: 0.0241, Validation Loss: 0.3481
Epoch [24/30], Train Loss: 0.0253, Validation Loss: 0.4557
Epoch [25/30], Train Loss: 0.0178, Validation Loss: 0.3559
Epoch [26/30], Train Loss: 0.0167, Validation Loss: 0.4692
Epoch [27/30], Train Loss: 0.0129, Validation Loss: 0.3608
Epoch [28/30], Train Loss: 0.0154, Validation Loss: 0.4198
Epoch [29/30], Train Loss: 0.0183, Validation Loss: 0.3734
Epoch [30/30], Train Loss: 0.0110, Validation Loss: 0.4167
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (EC_electric_conductivity): R^2 Score = 0.781, MSE = 0.158
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.084959 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407189
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold3
RF：
決定係数：0.7776964966878382
MAE：0.1453792228590503
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
XGB：
決定係数：0.7475947670463097
MAE：0.14448465406894684
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
LGB：
決定係数：0.7828958451460583
MAE：0.1424461676887275
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9728, Validation Loss: 1.0873
Epoch [2/30], Train Loss: 0.8771, Validation Loss: 1.0204
Epoch [3/30], Train Loss: 0.7938, Validation Loss: 0.9443
Epoch [4/30], Train Loss: 0.7071, Validation Loss: 0.8645
Epoch [5/30], Train Loss: 0.6076, Validation Loss: 0.7926
Epoch [6/30], Train Loss: 0.5101, Validation Loss: 0.6782
Epoch [7/30], Train Loss: 0.4128, Validation Loss: 0.5829
Epoch [8/30], Train Loss: 0.3331, Validation Loss: 0.4968
Epoch [9/30], Train Loss: 0.2661, Validation Loss: 0.4270
Epoch [10/30], Train Loss: 0.2201, Validation Loss: 0.3906
Epoch [11/30], Train Loss: 0.1804, Validation Loss: 0.3668
Epoch [12/30], Train Loss: 0.1503, Validation Loss: 0.3365
Epoch [13/30], Train Loss: 0.1195, Validation Loss: 0.3308
Epoch [14/30], Train Loss: 0.0938, Validation Loss: 0.3109
Epoch [15/30], Train Loss: 0.0845, Validation Loss: 0.3166
Epoch [16/30], Train Loss: 0.0621, Validation Loss: 0.3028
Epoch [17/30], Train Loss: 0.0515, Validation Loss: 0.3035
Epoch [18/30], Train Loss: 0.0405, Validation Loss: 0.3026
Epoch [19/30], Train Loss: 0.0355, Validation Loss: 0.2957
Epoch [20/30], Train Loss: 0.0277, Validation Loss: 0.2964
Epoch [21/30], Train Loss: 0.0235, Validation Loss: 0.2920
Epoch [22/30], Train Loss: 0.0176, Validation Loss: 0.2932
Epoch [23/30], Train Loss: 0.0121, Validation Loss: 0.2911
Epoch [24/30], Train Loss: 0.0139, Validation Loss: 0.2926
Epoch [25/30], Train Loss: 0.0100, Validation Loss: 0.3010
Epoch [26/30], Train Loss: 0.0096, Validation Loss: 0.2894
Epoch [27/30], Train Loss: 0.0073, Validation Loss: 0.2903
Epoch [28/30], Train Loss: 0.0126, Validation Loss: 0.2885
Epoch [29/30], Train Loss: 0.0094, Validation Loss: 0.2900
Epoch [30/30], Train Loss: 0.0048, Validation Loss: 0.2856
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_C): R^2 Score = 0.766, MSE = 0.978
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.051240 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407189
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold3
RF：
決定係数：0.7181475317140608
MAE：0.9902163235190552
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
XGB：
決定係数：0.7582965848922565
MAE：0.9331306219100952
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
LGB：
決定係数：0.7622673383088012
MAE：0.9638985690928977
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 282
テストデータ数: 353
Epoch [1/30], Train Loss: 0.9781, Validation Loss: 1.2468
Epoch [2/30], Train Loss: 0.8973, Validation Loss: 1.1969
Epoch [3/30], Train Loss: 0.8272, Validation Loss: 1.1477
Epoch [4/30], Train Loss: 0.7639, Validation Loss: 1.0977
Epoch [5/30], Train Loss: 0.7355, Validation Loss: 1.0533
Epoch [6/30], Train Loss: 0.6207, Validation Loss: 1.0112
Epoch [7/30], Train Loss: 0.5613, Validation Loss: 0.9514
Epoch [8/30], Train Loss: 0.4840, Validation Loss: 0.8793
Epoch [9/30], Train Loss: 0.4378, Validation Loss: 0.8258
Epoch [10/30], Train Loss: 0.3865, Validation Loss: 0.7965
Epoch [11/30], Train Loss: 0.3428, Validation Loss: 0.7658
Epoch [12/30], Train Loss: 0.3010, Validation Loss: 0.7628
Epoch [13/30], Train Loss: 0.2620, Validation Loss: 0.7217
Epoch [14/30], Train Loss: 0.2531, Validation Loss: 0.7136
Epoch [15/30], Train Loss: 0.2009, Validation Loss: 0.6990
Epoch [16/30], Train Loss: 0.1824, Validation Loss: 0.6775
Epoch [17/30], Train Loss: 0.1442, Validation Loss: 0.6693
Epoch [18/30], Train Loss: 0.1302, Validation Loss: 0.6638
Epoch [19/30], Train Loss: 0.1020, Validation Loss: 0.6555
Epoch [20/30], Train Loss: 0.0986, Validation Loss: 0.6402
Epoch [21/30], Train Loss: 0.0844, Validation Loss: 0.6446
Epoch [22/30], Train Loss: 0.0723, Validation Loss: 0.6475
Epoch [23/30], Train Loss: 0.0656, Validation Loss: 0.6611
Epoch [24/30], Train Loss: 0.0605, Validation Loss: 0.6710
Epoch [25/30], Train Loss: 0.0532, Validation Loss: 0.6621
Epoch [26/30], Train Loss: 0.0464, Validation Loss: 0.6747
Epoch [27/30], Train Loss: 0.0455, Validation Loss: 0.6735
Epoch [28/30], Train Loss: 0.0333, Validation Loss: 0.6768
Epoch [29/30], Train Loss: 0.0433, Validation Loss: 0.6692
Epoch [30/30], Train Loss: 0.0324, Validation Loss: 0.6760
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_N): R^2 Score = 0.558, MSE = 0.084
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.083614 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407189
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(353, 1)
(353, 1597)
fold3
RF：
決定係数：0.5254354718788978
MAE：0.07807008999158928
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/RF/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
XGB：
決定係数：0.508651070627216
MAE：0.07815465331077576
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/XGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold3
LGB：
決定係数：0.5348678700529116
MAE：0.08013300934745657
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold3/LGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1128, 1597)
特徴選択後：(1128, 1597)
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 4.9431, Validation Loss: 5.7249
Epoch [2/30], Train Loss: 4.6081, Validation Loss: 5.4527
Epoch [3/30], Train Loss: 4.3306, Validation Loss: 5.1463
Epoch [4/30], Train Loss: 4.0229, Validation Loss: 4.8580
Epoch [5/30], Train Loss: 3.6954, Validation Loss: 4.6101
Epoch [6/30], Train Loss: 3.3935, Validation Loss: 4.4159
Epoch [7/30], Train Loss: 3.0132, Validation Loss: 4.2412
Epoch [8/30], Train Loss: 2.7070, Validation Loss: 4.1217
Epoch [9/30], Train Loss: 2.4353, Validation Loss: 3.9525
Epoch [10/30], Train Loss: 2.1412, Validation Loss: 3.8373
Epoch [11/30], Train Loss: 1.9413, Validation Loss: 3.7423
Epoch [12/30], Train Loss: 1.7091, Validation Loss: 3.6598
Epoch [13/30], Train Loss: 1.5115, Validation Loss: 3.5403
Epoch [14/30], Train Loss: 1.3814, Validation Loss: 3.5600
Epoch [15/30], Train Loss: 1.2318, Validation Loss: 3.4944
Epoch [16/30], Train Loss: 1.1436, Validation Loss: 3.5394
Epoch [17/30], Train Loss: 1.0111, Validation Loss: 3.5106
Epoch [18/30], Train Loss: 0.9000, Validation Loss: 3.5234
Epoch [19/30], Train Loss: 0.8020, Validation Loss: 3.6080
Epoch [20/30], Train Loss: 0.7437, Validation Loss: 3.5183
Epoch [21/30], Train Loss: 0.6742, Validation Loss: 3.6192
Epoch [22/30], Train Loss: 0.5986, Validation Loss: 3.5550
Epoch [23/30], Train Loss: 0.5281, Validation Loss: 3.6428
Epoch [24/30], Train Loss: 0.5090, Validation Loss: 3.5948
Epoch [25/30], Train Loss: 0.4155, Validation Loss: 3.6330
Epoch [26/30], Train Loss: 0.4055, Validation Loss: 3.6412
Epoch [27/30], Train Loss: 0.3520, Validation Loss: 3.6334
Epoch [28/30], Train Loss: 0.3379, Validation Loss: 3.6524
Epoch [29/30], Train Loss: 0.2925, Validation Loss: 3.6725
Epoch [30/30], Train Loss: 0.2544, Validation Loss: 3.6553
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/MT/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/MT/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/MT/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/MT/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.655, MSE = 0.371
Output 2 (available_P): R^2 Score = 0.778, MSE = 337.357
Output 3 (EC_electric_conductivity): R^2 Score = 0.753, MSE = 0.163
Output 4 (Total_C): R^2 Score = 0.790, MSE = 0.922
Output 5 (Total_N): R^2 Score = 0.750, MSE = 0.074
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 4.9292, Validation Loss: 5.7475
Epoch [2/30], Train Loss: 4.6239, Validation Loss: 5.4756
Epoch [3/30], Train Loss: 4.3283, Validation Loss: 5.1863
Epoch [4/30], Train Loss: 4.0001, Validation Loss: 4.9033
Epoch [5/30], Train Loss: 3.6620, Validation Loss: 4.6549
Epoch [6/30], Train Loss: 3.3494, Validation Loss: 4.4650
Epoch [7/30], Train Loss: 3.0790, Validation Loss: 4.3137
Epoch [8/30], Train Loss: 2.7676, Validation Loss: 4.2114
Epoch [9/30], Train Loss: 2.4943, Validation Loss: 4.0563
Epoch [10/30], Train Loss: 2.2142, Validation Loss: 3.9418
Epoch [11/30], Train Loss: 1.9764, Validation Loss: 3.7642
Epoch [12/30], Train Loss: 1.7815, Validation Loss: 3.6236
Epoch [13/30], Train Loss: 1.6262, Validation Loss: 3.6145
Epoch [14/30], Train Loss: 1.4188, Validation Loss: 3.5191
Epoch [15/30], Train Loss: 1.2756, Validation Loss: 3.4889
Epoch [16/30], Train Loss: 1.1460, Validation Loss: 3.4757
Epoch [17/30], Train Loss: 1.0216, Validation Loss: 3.4714
Epoch [18/30], Train Loss: 0.9260, Validation Loss: 3.4557
Epoch [19/30], Train Loss: 0.8090, Validation Loss: 3.4919
Epoch [20/30], Train Loss: 0.7901, Validation Loss: 3.4593
Epoch [21/30], Train Loss: 0.6718, Validation Loss: 3.4939
Epoch [22/30], Train Loss: 0.5827, Validation Loss: 3.4875
Epoch [23/30], Train Loss: 0.5354, Validation Loss: 3.4825
Epoch [24/30], Train Loss: 0.4743, Validation Loss: 3.5119
Epoch [25/30], Train Loss: 0.4373, Validation Loss: 3.4943
Epoch [26/30], Train Loss: 0.4006, Validation Loss: 3.4993
Epoch [27/30], Train Loss: 0.3594, Validation Loss: 3.4861
Epoch [28/30], Train Loss: 0.3076, Validation Loss: 3.5463
Epoch [29/30], Train Loss: 0.2871, Validation Loss: 3.5033
Epoch [30/30], Train Loss: 0.2510, Validation Loss: 3.5266
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/MT_SUM/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/MT_SUM/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/MT_SUM/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/MT_SUM/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.667, MSE = 0.367
Output 2 (available_P): R^2 Score = 0.761, MSE = 338.687
Output 3 (EC_electric_conductivity): R^2 Score = 0.749, MSE = 0.166
Output 4 (Total_C): R^2 Score = 0.780, MSE = 0.963
Output 5 (Total_N): R^2 Score = 0.731, MSE = 0.078
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 0.9502, Validation Loss: 0.7888
Epoch [2/30], Train Loss: 0.8172, Validation Loss: 0.6871
Epoch [3/30], Train Loss: 0.7027, Validation Loss: 0.6123
Epoch [4/30], Train Loss: 0.5911, Validation Loss: 0.5576
Epoch [5/30], Train Loss: 0.5043, Validation Loss: 0.5137
Epoch [6/30], Train Loss: 0.4285, Validation Loss: 0.4721
Epoch [7/30], Train Loss: 0.3710, Validation Loss: 0.4371
Epoch [8/30], Train Loss: 0.3205, Validation Loss: 0.4171
Epoch [9/30], Train Loss: 0.2826, Validation Loss: 0.4129
Epoch [10/30], Train Loss: 0.2406, Validation Loss: 0.4007
Epoch [11/30], Train Loss: 0.2231, Validation Loss: 0.4107
Epoch [12/30], Train Loss: 0.1821, Validation Loss: 0.4093
Epoch [13/30], Train Loss: 0.1510, Validation Loss: 0.4023
Epoch [14/30], Train Loss: 0.1297, Validation Loss: 0.4257
Epoch [15/30], Train Loss: 0.1083, Validation Loss: 0.4111
Epoch [16/30], Train Loss: 0.0866, Validation Loss: 0.4411
Epoch [17/30], Train Loss: 0.0730, Validation Loss: 0.4422
Epoch [18/30], Train Loss: 0.0586, Validation Loss: 0.4213
Epoch [19/30], Train Loss: 0.0487, Validation Loss: 0.4527
Epoch [20/30], Train Loss: 0.0365, Validation Loss: 0.4345
Epoch [21/30], Train Loss: 0.0276, Validation Loss: 0.4535
Epoch [22/30], Train Loss: 0.0308, Validation Loss: 0.4425
Epoch [23/30], Train Loss: 0.0178, Validation Loss: 0.4488
Epoch [24/30], Train Loss: 0.0204, Validation Loss: 0.4419
Epoch [25/30], Train Loss: 0.0135, Validation Loss: 0.4775
Epoch [26/30], Train Loss: 0.0190, Validation Loss: 0.4584
Epoch [27/30], Train Loss: 0.0143, Validation Loss: 0.4459
Epoch [28/30], Train Loss: 0.0085, Validation Loss: 0.4898
Epoch [29/30], Train Loss: 0.0083, Validation Loss: 0.4503
Epoch [30/30], Train Loss: 0.0077, Validation Loss: 0.4909
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.670, MSE = 0.374
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.089307 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407186
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(352, 1)
(352, 1597)
fold4
RF：
決定係数：0.7143679253548453
MAE：0.32977685205508317
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
XGB：
決定係数：0.7059642716338463
MAE：0.3468528091907501
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
LGB：
決定係数：0.7114220003019369
MAE：0.3328216409988347
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 0.9678, Validation Loss: 0.8934
Epoch [2/30], Train Loss: 0.8404, Validation Loss: 0.7447
Epoch [3/30], Train Loss: 0.7408, Validation Loss: 0.6260
Epoch [4/30], Train Loss: 0.6310, Validation Loss: 0.5183
Epoch [5/30], Train Loss: 0.5147, Validation Loss: 0.4795
Epoch [6/30], Train Loss: 0.4190, Validation Loss: 0.4216
Epoch [7/30], Train Loss: 0.3345, Validation Loss: 0.3527
Epoch [8/30], Train Loss: 0.2750, Validation Loss: 0.3395
Epoch [9/30], Train Loss: 0.2307, Validation Loss: 0.3038
Epoch [10/30], Train Loss: 0.1929, Validation Loss: 0.2921
Epoch [11/30], Train Loss: 0.1635, Validation Loss: 0.2860
Epoch [12/30], Train Loss: 0.1378, Validation Loss: 0.2750
Epoch [13/30], Train Loss: 0.1158, Validation Loss: 0.2735
Epoch [14/30], Train Loss: 0.0986, Validation Loss: 0.2743
Epoch [15/30], Train Loss: 0.0864, Validation Loss: 0.2773
Epoch [16/30], Train Loss: 0.0622, Validation Loss: 0.2797
Epoch [17/30], Train Loss: 0.0564, Validation Loss: 0.2837
Epoch [18/30], Train Loss: 0.0428, Validation Loss: 0.3013
Epoch [19/30], Train Loss: 0.0331, Validation Loss: 0.2916
Epoch [20/30], Train Loss: 0.0277, Validation Loss: 0.3080
Epoch [21/30], Train Loss: 0.0233, Validation Loss: 0.2963
Epoch [22/30], Train Loss: 0.0202, Validation Loss: 0.3112
Epoch [23/30], Train Loss: 0.0167, Validation Loss: 0.3027
Epoch [24/30], Train Loss: 0.0160, Validation Loss: 0.3159
Epoch [25/30], Train Loss: 0.0113, Validation Loss: 0.3051
Epoch [26/30], Train Loss: 0.0100, Validation Loss: 0.3166
Epoch [27/30], Train Loss: 0.0070, Validation Loss: 0.3052
Epoch [28/30], Train Loss: 0.0095, Validation Loss: 0.3060
Epoch [29/30], Train Loss: 0.0115, Validation Loss: 0.3038
Epoch [30/30], Train Loss: 0.0113, Validation Loss: 0.3107
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (available_P): R^2 Score = 0.792, MSE = 289.839
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.084002 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407186
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(352, 1)
(352, 1597)
fold4
RF：
決定係数：0.7454936970706234
MAE：363.95131832930025
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
XGB：
決定係数：0.7113628063396767
MAE：373.1252136230469
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
LGB：
決定係数：0.7448761785311911
MAE：344.906449912379
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 0.9864, Validation Loss: 0.6318
Epoch [2/30], Train Loss: 0.8079, Validation Loss: 0.5159
Epoch [3/30], Train Loss: 0.6797, Validation Loss: 0.4326
Epoch [4/30], Train Loss: 0.5877, Validation Loss: 0.3832
Epoch [5/30], Train Loss: 0.5034, Validation Loss: 0.3531
Epoch [6/30], Train Loss: 0.4343, Validation Loss: 0.3338
Epoch [7/30], Train Loss: 0.3881, Validation Loss: 0.3189
Epoch [8/30], Train Loss: 0.3386, Validation Loss: 0.3073
Epoch [9/30], Train Loss: 0.2865, Validation Loss: 0.2893
Epoch [10/30], Train Loss: 0.2449, Validation Loss: 0.2827
Epoch [11/30], Train Loss: 0.2117, Validation Loss: 0.2757
Epoch [12/30], Train Loss: 0.1775, Validation Loss: 0.2724
Epoch [13/30], Train Loss: 0.1456, Validation Loss: 0.2748
Epoch [14/30], Train Loss: 0.1285, Validation Loss: 0.2814
Epoch [15/30], Train Loss: 0.1105, Validation Loss: 0.2892
Epoch [16/30], Train Loss: 0.0902, Validation Loss: 0.2984
Epoch [17/30], Train Loss: 0.0755, Validation Loss: 0.3012
Epoch [18/30], Train Loss: 0.0602, Validation Loss: 0.3061
Epoch [19/30], Train Loss: 0.0533, Validation Loss: 0.3208
Epoch [20/30], Train Loss: 0.0385, Validation Loss: 0.3164
Epoch [21/30], Train Loss: 0.0286, Validation Loss: 0.3244
Epoch [22/30], Train Loss: 0.0230, Validation Loss: 0.3292
Epoch [23/30], Train Loss: 0.0195, Validation Loss: 0.3358
Epoch [24/30], Train Loss: 0.0215, Validation Loss: 0.3374
Epoch [25/30], Train Loss: 0.0146, Validation Loss: 0.3401
Epoch [26/30], Train Loss: 0.0098, Validation Loss: 0.3433
Epoch [27/30], Train Loss: 0.0125, Validation Loss: 0.3448
Epoch [28/30], Train Loss: 0.0100, Validation Loss: 0.3430
Epoch [29/30], Train Loss: 0.0120, Validation Loss: 0.3507
Epoch [30/30], Train Loss: 0.0084, Validation Loss: 0.3486
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (EC_electric_conductivity): R^2 Score = 0.751, MSE = 0.163
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.085501 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407186
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(352, 1)
(352, 1597)
fold4
RF：
決定係数：0.7374048933145085
MAE：0.15269198595065941
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
XGB：
決定係数：0.6619600230565256
MAE：0.16812051832675934
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
LGB：
決定係数：0.7492719913065128
MAE：0.1561296106936922
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 0.9642, Validation Loss: 0.9322
Epoch [2/30], Train Loss: 0.8649, Validation Loss: 0.8742
Epoch [3/30], Train Loss: 0.7790, Validation Loss: 0.8145
Epoch [4/30], Train Loss: 0.6873, Validation Loss: 0.7585
Epoch [5/30], Train Loss: 0.5858, Validation Loss: 0.7245
Epoch [6/30], Train Loss: 0.4894, Validation Loss: 0.6687
Epoch [7/30], Train Loss: 0.3924, Validation Loss: 0.6139
Epoch [8/30], Train Loss: 0.3126, Validation Loss: 0.5688
Epoch [9/30], Train Loss: 0.2461, Validation Loss: 0.5188
Epoch [10/30], Train Loss: 0.1938, Validation Loss: 0.4944
Epoch [11/30], Train Loss: 0.1557, Validation Loss: 0.4884
Epoch [12/30], Train Loss: 0.1250, Validation Loss: 0.4770
Epoch [13/30], Train Loss: 0.0970, Validation Loss: 0.4695
Epoch [14/30], Train Loss: 0.0783, Validation Loss: 0.4718
Epoch [15/30], Train Loss: 0.0656, Validation Loss: 0.4710
Epoch [16/30], Train Loss: 0.0474, Validation Loss: 0.4742
Epoch [17/30], Train Loss: 0.0435, Validation Loss: 0.4702
Epoch [18/30], Train Loss: 0.0303, Validation Loss: 0.4728
Epoch [19/30], Train Loss: 0.0225, Validation Loss: 0.4823
Epoch [20/30], Train Loss: 0.0219, Validation Loss: 0.4686
Epoch [21/30], Train Loss: 0.0304, Validation Loss: 0.5025
Epoch [22/30], Train Loss: 0.0190, Validation Loss: 0.4727
Epoch [23/30], Train Loss: 0.0107, Validation Loss: 0.5045
Epoch [24/30], Train Loss: 0.0255, Validation Loss: 0.4715
Epoch [25/30], Train Loss: 0.0078, Validation Loss: 0.4954
Epoch [26/30], Train Loss: 0.0117, Validation Loss: 0.4699
Epoch [27/30], Train Loss: 0.0112, Validation Loss: 0.4830
Epoch [28/30], Train Loss: 0.0078, Validation Loss: 0.4702
Epoch [29/30], Train Loss: 0.0071, Validation Loss: 0.4747
Epoch [30/30], Train Loss: 0.0082, Validation Loss: 0.4743
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_C): R^2 Score = 0.802, MSE = 0.849
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.088086 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407186
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(352, 1)
(352, 1597)
fold4
RF：
決定係数：0.7616207306674051
MAE：0.9511743902866688
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
XGB：
決定係数：0.741719183194907
MAE：0.9956467151641846
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
LGB：
決定係数：0.7412032188289369
MAE：0.9773813566204281
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 0.9816, Validation Loss: 2.1638
Epoch [2/30], Train Loss: 0.9154, Validation Loss: 2.1303
Epoch [3/30], Train Loss: 0.8516, Validation Loss: 2.0973
Epoch [4/30], Train Loss: 0.7910, Validation Loss: 2.0748
Epoch [5/30], Train Loss: 0.7351, Validation Loss: 2.0672
Epoch [6/30], Train Loss: 0.6666, Validation Loss: 2.0728
Epoch [7/30], Train Loss: 0.6027, Validation Loss: 2.0833
Epoch [8/30], Train Loss: 0.5389, Validation Loss: 2.0732
Epoch [9/30], Train Loss: 0.4890, Validation Loss: 2.0672
Epoch [10/30], Train Loss: 0.4342, Validation Loss: 2.0461
Epoch [11/30], Train Loss: 0.3747, Validation Loss: 1.9821
Epoch [12/30], Train Loss: 0.3283, Validation Loss: 1.9879
Epoch [13/30], Train Loss: 0.2836, Validation Loss: 1.9687
Epoch [14/30], Train Loss: 0.2429, Validation Loss: 1.9377
Epoch [15/30], Train Loss: 0.2023, Validation Loss: 1.9786
Epoch [16/30], Train Loss: 0.1813, Validation Loss: 1.9239
Epoch [17/30], Train Loss: 0.1646, Validation Loss: 1.9823
Epoch [18/30], Train Loss: 0.1390, Validation Loss: 1.8567
Epoch [19/30], Train Loss: 0.1225, Validation Loss: 1.9565
Epoch [20/30], Train Loss: 0.1077, Validation Loss: 1.8707
Epoch [21/30], Train Loss: 0.0868, Validation Loss: 1.9043
Epoch [22/30], Train Loss: 0.0889, Validation Loss: 1.8553
Epoch [23/30], Train Loss: 0.0789, Validation Loss: 1.8937
Epoch [24/30], Train Loss: 0.0655, Validation Loss: 1.8388
Epoch [25/30], Train Loss: 0.0682, Validation Loss: 1.8930
Epoch [26/30], Train Loss: 0.0580, Validation Loss: 1.8736
Epoch [27/30], Train Loss: 0.0486, Validation Loss: 1.8559
Epoch [28/30], Train Loss: 0.0452, Validation Loss: 1.8509
Epoch [29/30], Train Loss: 0.0451, Validation Loss: 1.9009
Epoch [30/30], Train Loss: 0.0449, Validation Loss: 1.8389
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_N): R^2 Score = 0.704, MSE = 0.079
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.072931 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407186
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(352, 1)
(352, 1597)
fold4
RF：
決定係数：0.602924797102788
MAE：0.07758119246004261
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/RF/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
XGB：
決定係数：0.5947450396581453
MAE：0.0780429095029831
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/XGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold4
LGB：
決定係数：0.6904186445424341
MAE：0.07106052088380911
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold4/LGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
特徴選択前：(1128, 1597)
特徴選択後：(1128, 1597)
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 4.9497, Validation Loss: 9.3824
Epoch [2/30], Train Loss: 4.6509, Validation Loss: 9.2015
Epoch [3/30], Train Loss: 4.3891, Validation Loss: 9.0066
Epoch [4/30], Train Loss: 4.0620, Validation Loss: 8.8072
Epoch [5/30], Train Loss: 3.7126, Validation Loss: 8.6006
Epoch [6/30], Train Loss: 3.3469, Validation Loss: 8.4315
Epoch [7/30], Train Loss: 2.9885, Validation Loss: 8.2679
Epoch [8/30], Train Loss: 2.6496, Validation Loss: 8.0824
Epoch [9/30], Train Loss: 2.3509, Validation Loss: 7.9355
Epoch [10/30], Train Loss: 2.0328, Validation Loss: 7.7696
Epoch [11/30], Train Loss: 1.7717, Validation Loss: 7.6949
Epoch [12/30], Train Loss: 1.5423, Validation Loss: 7.5542
Epoch [13/30], Train Loss: 1.3831, Validation Loss: 7.5274
Epoch [14/30], Train Loss: 1.1953, Validation Loss: 7.5060
Epoch [15/30], Train Loss: 1.0714, Validation Loss: 7.4460
Epoch [16/30], Train Loss: 0.9593, Validation Loss: 7.4704
Epoch [17/30], Train Loss: 0.8383, Validation Loss: 7.4635
Epoch [18/30], Train Loss: 0.7511, Validation Loss: 7.4549
Epoch [19/30], Train Loss: 0.6635, Validation Loss: 7.4704
Epoch [20/30], Train Loss: 0.5838, Validation Loss: 7.4501
Epoch [21/30], Train Loss: 0.5076, Validation Loss: 7.4852
Epoch [22/30], Train Loss: 0.4515, Validation Loss: 7.4506
Epoch [23/30], Train Loss: 0.3989, Validation Loss: 7.4968
Epoch [24/30], Train Loss: 0.3637, Validation Loss: 7.4625
Epoch [25/30], Train Loss: 0.3229, Validation Loss: 7.5374
Epoch [26/30], Train Loss: 0.2857, Validation Loss: 7.4615
Epoch [27/30], Train Loss: 0.2601, Validation Loss: 7.4718
Epoch [28/30], Train Loss: 0.2333, Validation Loss: 7.5489
Epoch [29/30], Train Loss: 0.2077, Validation Loss: 7.4802
Epoch [30/30], Train Loss: 0.1771, Validation Loss: 7.5215
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/MT/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/MT/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/MT/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/MT/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.716, MSE = 0.375
Output 2 (available_P): R^2 Score = 0.751, MSE = 458.074
Output 3 (EC_electric_conductivity): R^2 Score = 0.775, MSE = 0.167
Output 4 (Total_C): R^2 Score = 0.822, MSE = 0.890
Output 5 (Total_N): R^2 Score = 0.652, MSE = 0.074
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 4.9068, Validation Loss: 9.2906
Epoch [2/30], Train Loss: 4.5508, Validation Loss: 9.0747
Epoch [3/30], Train Loss: 4.2471, Validation Loss: 8.8212
Epoch [4/30], Train Loss: 3.9099, Validation Loss: 8.5877
Epoch [5/30], Train Loss: 3.5423, Validation Loss: 8.3893
Epoch [6/30], Train Loss: 3.1866, Validation Loss: 8.2200
Epoch [7/30], Train Loss: 2.8419, Validation Loss: 8.0433
Epoch [8/30], Train Loss: 2.5215, Validation Loss: 7.8548
Epoch [9/30], Train Loss: 2.2191, Validation Loss: 7.6937
Epoch [10/30], Train Loss: 1.9682, Validation Loss: 7.5416
Epoch [11/30], Train Loss: 1.7191, Validation Loss: 7.4636
Epoch [12/30], Train Loss: 1.5298, Validation Loss: 7.3350
Epoch [13/30], Train Loss: 1.3384, Validation Loss: 7.3593
Epoch [14/30], Train Loss: 1.1916, Validation Loss: 7.2989
Epoch [15/30], Train Loss: 1.0578, Validation Loss: 7.2881
Epoch [16/30], Train Loss: 0.9621, Validation Loss: 7.2886
Epoch [17/30], Train Loss: 0.8571, Validation Loss: 7.3000
Epoch [18/30], Train Loss: 0.7638, Validation Loss: 7.2689
Epoch [19/30], Train Loss: 0.6543, Validation Loss: 7.3149
Epoch [20/30], Train Loss: 0.6189, Validation Loss: 7.2778
Epoch [21/30], Train Loss: 0.5454, Validation Loss: 7.3252
Epoch [22/30], Train Loss: 0.4871, Validation Loss: 7.2740
Epoch [23/30], Train Loss: 0.4369, Validation Loss: 7.3400
Epoch [24/30], Train Loss: 0.3901, Validation Loss: 7.2805
Epoch [25/30], Train Loss: 0.3517, Validation Loss: 7.3583
Epoch [26/30], Train Loss: 0.3196, Validation Loss: 7.3102
Epoch [27/30], Train Loss: 0.3055, Validation Loss: 7.3341
Epoch [28/30], Train Loss: 0.2641, Validation Loss: 7.3497
Epoch [29/30], Train Loss: 0.2408, Validation Loss: 7.3428
Epoch [30/30], Train Loss: 0.2063, Validation Loss: 7.3506
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/MT_SUM/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/MT_SUM/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/MT_SUM/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/MT_SUM/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.690, MSE = 0.389
Output 2 (available_P): R^2 Score = 0.738, MSE = 464.179
Output 3 (EC_electric_conductivity): R^2 Score = 0.766, MSE = 0.167
Output 4 (Total_C): R^2 Score = 0.805, MSE = 0.904
Output 5 (Total_N): R^2 Score = 0.654, MSE = 0.074
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 0.9650, Validation Loss: 0.8059
Epoch [2/30], Train Loss: 0.8458, Validation Loss: 0.7424
Epoch [3/30], Train Loss: 0.7391, Validation Loss: 0.6813
Epoch [4/30], Train Loss: 0.6379, Validation Loss: 0.6314
Epoch [5/30], Train Loss: 0.5395, Validation Loss: 0.5984
Epoch [6/30], Train Loss: 0.4622, Validation Loss: 0.5841
Epoch [7/30], Train Loss: 0.3925, Validation Loss: 0.5687
Epoch [8/30], Train Loss: 0.3410, Validation Loss: 0.5581
Epoch [9/30], Train Loss: 0.2966, Validation Loss: 0.5568
Epoch [10/30], Train Loss: 0.2521, Validation Loss: 0.5501
Epoch [11/30], Train Loss: 0.2184, Validation Loss: 0.5523
Epoch [12/30], Train Loss: 0.1842, Validation Loss: 0.5568
Epoch [13/30], Train Loss: 0.1568, Validation Loss: 0.5514
Epoch [14/30], Train Loss: 0.1312, Validation Loss: 0.5575
Epoch [15/30], Train Loss: 0.1116, Validation Loss: 0.5615
Epoch [16/30], Train Loss: 0.0900, Validation Loss: 0.5682
Epoch [17/30], Train Loss: 0.0720, Validation Loss: 0.5688
Epoch [18/30], Train Loss: 0.0596, Validation Loss: 0.5787
Epoch [19/30], Train Loss: 0.0464, Validation Loss: 0.5830
Epoch [20/30], Train Loss: 0.0354, Validation Loss: 0.5752
Epoch [21/30], Train Loss: 0.0299, Validation Loss: 0.5772
Epoch [22/30], Train Loss: 0.0239, Validation Loss: 0.5896
Epoch [23/30], Train Loss: 0.0195, Validation Loss: 0.5881
Epoch [24/30], Train Loss: 0.0294, Validation Loss: 0.5870
Epoch [25/30], Train Loss: 0.0138, Validation Loss: 0.5915
Epoch [26/30], Train Loss: 0.0123, Validation Loss: 0.5875
Epoch [27/30], Train Loss: 0.0150, Validation Loss: 0.5961
Epoch [28/30], Train Loss: 0.0203, Validation Loss: 0.5919
Epoch [29/30], Train Loss: 0.0067, Validation Loss: 0.5888
Epoch [30/30], Train Loss: 0.0172, Validation Loss: 0.5945
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (pH_dry_soil): R^2 Score = 0.703, MSE = 0.387
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.097546 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407194
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(352, 1)
(352, 1597)
fold5
RF：
決定係数：0.7325642383105923
MAE：0.3585717010761602
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
XGB：
決定係数：0.6949708674901541
MAE：0.368467777967453
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
LGB：
決定係数：0.7134350757421704
MAE：0.3540357746923858
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/pH_dry_soil/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/pH_dry_soil/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/pH_dry_soil/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 0.9637, Validation Loss: 1.0340
Epoch [2/30], Train Loss: 0.8705, Validation Loss: 0.9388
Epoch [3/30], Train Loss: 0.7845, Validation Loss: 0.8490
Epoch [4/30], Train Loss: 0.7034, Validation Loss: 0.7718
Epoch [5/30], Train Loss: 0.6164, Validation Loss: 0.6778
Epoch [6/30], Train Loss: 0.5344, Validation Loss: 0.5755
Epoch [7/30], Train Loss: 0.4335, Validation Loss: 0.4994
Epoch [8/30], Train Loss: 0.3546, Validation Loss: 0.4374
Epoch [9/30], Train Loss: 0.2757, Validation Loss: 0.3836
Epoch [10/30], Train Loss: 0.2316, Validation Loss: 0.3578
Epoch [11/30], Train Loss: 0.1880, Validation Loss: 0.3421
Epoch [12/30], Train Loss: 0.1537, Validation Loss: 0.3324
Epoch [13/30], Train Loss: 0.1169, Validation Loss: 0.3283
Epoch [14/30], Train Loss: 0.1207, Validation Loss: 0.3298
Epoch [15/30], Train Loss: 0.0886, Validation Loss: 0.3256
Epoch [16/30], Train Loss: 0.0695, Validation Loss: 0.3295
Epoch [17/30], Train Loss: 0.0577, Validation Loss: 0.3280
Epoch [18/30], Train Loss: 0.0429, Validation Loss: 0.3304
Epoch [19/30], Train Loss: 0.0344, Validation Loss: 0.3292
Epoch [20/30], Train Loss: 0.0299, Validation Loss: 0.3280
Epoch [21/30], Train Loss: 0.0237, Validation Loss: 0.3302
Epoch [22/30], Train Loss: 0.0193, Validation Loss: 0.3348
Epoch [23/30], Train Loss: 0.0185, Validation Loss: 0.3327
Epoch [24/30], Train Loss: 0.0193, Validation Loss: 0.3527
Epoch [25/30], Train Loss: 0.0143, Validation Loss: 0.3362
Epoch [26/30], Train Loss: 0.0115, Validation Loss: 0.3327
Epoch [27/30], Train Loss: 0.0149, Validation Loss: 0.3306
Epoch [28/30], Train Loss: 0.0086, Validation Loss: 0.3304
Epoch [29/30], Train Loss: 0.0118, Validation Loss: 0.3356
Epoch [30/30], Train Loss: 0.0084, Validation Loss: 0.3365
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (available_P): R^2 Score = 0.761, MSE = 427.330
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.092653 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407194
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(352, 1)
(352, 1597)
fold5
RF：
決定係数：0.7416378064935722
MAE：442.7347284459733
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
XGB：
決定係数：0.7289831411043024
MAE：445.4173583984375
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
LGB：
決定係数：0.7514267798485748
MAE：437.36689518500685
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/available_P/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/available_P/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/available_P/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 0.9293, Validation Loss: 0.4658
Epoch [2/30], Train Loss: 0.7678, Validation Loss: 0.3654
Epoch [3/30], Train Loss: 0.6320, Validation Loss: 0.3016
Epoch [4/30], Train Loss: 0.5386, Validation Loss: 0.2683
Epoch [5/30], Train Loss: 0.4650, Validation Loss: 0.2448
Epoch [6/30], Train Loss: 0.4039, Validation Loss: 0.2266
Epoch [7/30], Train Loss: 0.3657, Validation Loss: 0.2148
Epoch [8/30], Train Loss: 0.3167, Validation Loss: 0.2090
Epoch [9/30], Train Loss: 0.2732, Validation Loss: 0.2024
Epoch [10/30], Train Loss: 0.2398, Validation Loss: 0.1946
Epoch [11/30], Train Loss: 0.2071, Validation Loss: 0.2081
Epoch [12/30], Train Loss: 0.1758, Validation Loss: 0.2078
Epoch [13/30], Train Loss: 0.1466, Validation Loss: 0.2134
Epoch [14/30], Train Loss: 0.1258, Validation Loss: 0.2239
Epoch [15/30], Train Loss: 0.1093, Validation Loss: 0.2262
Epoch [16/30], Train Loss: 0.0896, Validation Loss: 0.2319
Epoch [17/30], Train Loss: 0.0754, Validation Loss: 0.2311
Epoch [18/30], Train Loss: 0.0601, Validation Loss: 0.2532
Epoch [19/30], Train Loss: 0.0510, Validation Loss: 0.2389
Epoch [20/30], Train Loss: 0.0377, Validation Loss: 0.2508
Epoch [21/30], Train Loss: 0.0278, Validation Loss: 0.2415
Epoch [22/30], Train Loss: 0.0256, Validation Loss: 0.2609
Epoch [23/30], Train Loss: 0.0212, Validation Loss: 0.2481
Epoch [24/30], Train Loss: 0.0168, Validation Loss: 0.2577
Epoch [25/30], Train Loss: 0.0139, Validation Loss: 0.2546
Epoch [26/30], Train Loss: 0.0154, Validation Loss: 0.2516
Epoch [27/30], Train Loss: 0.0085, Validation Loss: 0.2796
Epoch [28/30], Train Loss: 0.0109, Validation Loss: 0.2524
Epoch [29/30], Train Loss: 0.0138, Validation Loss: 0.2533
Epoch [30/30], Train Loss: 0.0097, Validation Loss: 0.2536
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (EC_electric_conductivity): R^2 Score = 0.782, MSE = 0.159
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.080352 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407194
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score 0.000000
LGBの学習が完了しました
(352, 1)
(352, 1597)
fold5
RF：
決定係数：0.7272983456937676
MAE：0.15585817697391183
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
XGB：
決定係数：0.6516925667296448
MAE：0.15414761006832123
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
LGB：
決定係数：0.7426273396532614
MAE：0.15235856614474483
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/EC_electric_conductivity/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/EC_electric_conductivity/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/EC_electric_conductivity/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 1.0190, Validation Loss: 1.0968
Epoch [2/30], Train Loss: 0.9418, Validation Loss: 1.0396
Epoch [3/30], Train Loss: 0.8692, Validation Loss: 0.9899
Epoch [4/30], Train Loss: 0.7891, Validation Loss: 0.9367
Epoch [5/30], Train Loss: 0.6840, Validation Loss: 0.8894
Epoch [6/30], Train Loss: 0.5942, Validation Loss: 0.8478
Epoch [7/30], Train Loss: 0.4851, Validation Loss: 0.7989
Epoch [8/30], Train Loss: 0.3781, Validation Loss: 0.7466
Epoch [9/30], Train Loss: 0.2881, Validation Loss: 0.6852
Epoch [10/30], Train Loss: 0.2279, Validation Loss: 0.6401
Epoch [11/30], Train Loss: 0.1840, Validation Loss: 0.6141
Epoch [12/30], Train Loss: 0.1535, Validation Loss: 0.6018
Epoch [13/30], Train Loss: 0.1240, Validation Loss: 0.5997
Epoch [14/30], Train Loss: 0.1000, Validation Loss: 0.6088
Epoch [15/30], Train Loss: 0.0739, Validation Loss: 0.6033
Epoch [16/30], Train Loss: 0.0589, Validation Loss: 0.6030
Epoch [17/30], Train Loss: 0.0509, Validation Loss: 0.6122
Epoch [18/30], Train Loss: 0.0457, Validation Loss: 0.6108
Epoch [19/30], Train Loss: 0.0336, Validation Loss: 0.6188
Epoch [20/30], Train Loss: 0.0226, Validation Loss: 0.6147
Epoch [21/30], Train Loss: 0.0254, Validation Loss: 0.6145
Epoch [22/30], Train Loss: 0.0162, Validation Loss: 0.6195
Epoch [23/30], Train Loss: 0.0166, Validation Loss: 0.6278
Epoch [24/30], Train Loss: 0.0103, Validation Loss: 0.6212
Epoch [25/30], Train Loss: 0.0104, Validation Loss: 0.6261
Epoch [26/30], Train Loss: 0.0089, Validation Loss: 0.6197
Epoch [27/30], Train Loss: 0.0117, Validation Loss: 0.6338
Epoch [28/30], Train Loss: 0.0100, Validation Loss: 0.6244
Epoch [29/30], Train Loss: 0.0112, Validation Loss: 0.6190
Epoch [30/30], Train Loss: 0.0048, Validation Loss: 0.6246
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_C): R^2 Score = 0.812, MSE = 0.892
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.062494 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407194
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(352, 1)
(352, 1597)
fold5
RF：
決定係数：0.7246975086453153
MAE：0.9569083007668227
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
XGB：
決定係数：0.7444966312609095
MAE：0.9343381524085999
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
LGB：
決定係数：0.7627174613302737
MAE：0.9219011181744473
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/Total_C/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/Total_C/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/Total_C/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
torch.Size([1128, 1597])
学習データ数: 1128
検証データ数: 283
テストデータ数: 352
Epoch [1/30], Train Loss: 0.9844, Validation Loss: 5.7099
Epoch [2/30], Train Loss: 0.9323, Validation Loss: 5.6910
Epoch [3/30], Train Loss: 0.8160, Validation Loss: 5.6809
Epoch [4/30], Train Loss: 0.7358, Validation Loss: 5.6850
Epoch [5/30], Train Loss: 0.6506, Validation Loss: 5.7116
Epoch [6/30], Train Loss: 0.5572, Validation Loss: 5.7457
Epoch [7/30], Train Loss: 0.4802, Validation Loss: 5.7285
Epoch [8/30], Train Loss: 0.4017, Validation Loss: 5.7067
Epoch [9/30], Train Loss: 0.3406, Validation Loss: 5.6946
Epoch [10/30], Train Loss: 0.2941, Validation Loss: 5.6720
Epoch [11/30], Train Loss: 0.2511, Validation Loss: 5.6392
Epoch [12/30], Train Loss: 0.2339, Validation Loss: 5.6363
Epoch [13/30], Train Loss: 0.1870, Validation Loss: 5.6134
Epoch [14/30], Train Loss: 0.1509, Validation Loss: 5.6069
Epoch [15/30], Train Loss: 0.1276, Validation Loss: 5.5908
Epoch [16/30], Train Loss: 0.1174, Validation Loss: 5.6198
Epoch [17/30], Train Loss: 0.0922, Validation Loss: 5.5829
Epoch [18/30], Train Loss: 0.0728, Validation Loss: 5.6339
Epoch [19/30], Train Loss: 0.0559, Validation Loss: 5.5590
Epoch [20/30], Train Loss: 0.0443, Validation Loss: 5.5775
Epoch [21/30], Train Loss: 0.0412, Validation Loss: 5.5986
Epoch [22/30], Train Loss: 0.0354, Validation Loss: 5.6026
Epoch [23/30], Train Loss: 0.0245, Validation Loss: 5.5809
Epoch [24/30], Train Loss: 0.0224, Validation Loss: 5.5995
Epoch [25/30], Train Loss: 0.0162, Validation Loss: 5.6015
Epoch [26/30], Train Loss: 0.0160, Validation Loss: 5.5876
Epoch [27/30], Train Loss: 0.0152, Validation Loss: 5.6071
Epoch [28/30], Train Loss: 0.0094, Validation Loss: 5.5910
Epoch [29/30], Train Loss: 0.0122, Validation Loss: 5.6276
Epoch [30/30], Train Loss: 0.0204, Validation Loss: 5.5934
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_train/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_train/histograms' ディレクトリに保存しました。
CSVファイルを作成中...
CSVファイルを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_test/shared_features_and_predictions.csv' に保存しました。
ヒストグラムを次元ごとに作成中...
ヒストグラムを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/ST/feature_test/histograms' ディレクトリに保存しました。
Output 1 (Total_N): R^2 Score = 0.653, MSE = 0.077
RFの学習が完了しました
XGBの学習が完了しました
[LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.068106 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 407194
[LightGBM] [Info] Number of data points in the train set: 1128, number of used features: 1597
[LightGBM] [Info] Start training from score -0.000000
LGBの学習が完了しました
(352, 1)
(352, 1597)
fold5
RF：
決定係数：0.5637740145931598
MAE：0.07431241112017227
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/RF/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
XGB：
決定係数：0.5443699129744553
MAE：0.07581540942192078
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/XGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
fold5
LGB：
決定係数：0.5595896924304077
MAE：0.07234492373072604
SHAP分析を開始します...
SHAP値を計算中...
SHAP値の計算が完了しました。
SHAP値を 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/Total_N/shap_values.csv' に保存しました。
サマリープロットを作成中...
サマリープロットを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/Total_N/summary_plot.png' に保存しました。
平均SHAP値の棒グラフを作成中...
平均SHAP値の棒グラフを 'result_DRA_NN/['pH_dry_soil', 'available_P', 'EC_electric_conductivity', 'Total_C', 'Total_N']/fold5/LGB/Total_N/mean_shap_bar_plot.png' に保存しました。
SHAP分析が正常に完了しました！
{'MAE': {'LGB': {'EC_electric_conductivity': '0.156±0.009',
                 'Total_C': '0.922±0.044',
                 'Total_N': '0.077±0.005',
                 'available_P': '398.234±31.713',
                 'pH_dry_soil': '0.342±0.016'},
         'MT': {'EC_electric_conductivity': '0.172±0.011',
                'Total_C': '0.919±0.034',
                'Total_N': '0.080±0.005',
                'available_P': '400.939±38.931',
                'pH_dry_soil': '0.367±0.006'},
         'MT_SUM': {'EC_electric_conductivity': '0.169±0.008',
                    'Total_C': '0.929±0.037',
                    'Total_N': '0.082±0.007',
                    'available_P': '401.114±43.755',
                    'pH_dry_soil': '0.373±0.015'},
         'RF': {'EC_electric_conductivity': '0.155±0.006',
                'Total_C': '0.931±0.046',
                'Total_N': '0.079±0.003',
                'available_P': '412.039±29.685',
                'pH_dry_soil': '0.335±0.014'},
         'ST': {'EC_electric_conductivity': '0.162±0.003',
                'Total_C': '0.891±0.062',
                'Total_N': '0.084±0.006',
                'available_P': '354.858±43.846',
                'pH_dry_soil': '0.375±0.014'},
         'XGB': {'EC_electric_conductivity': '0.158±0.008',
                 'Total_C': '0.927±0.040',
                 'Total_N': '0.077±0.002',
                 'available_P': '402.306±25.239',
                 'pH_dry_soil': '0.352±0.009'}},
 'R': {'LGB': {'EC_electric_conductivity': '0.737±0.032',
               'Total_C': '0.759±0.023',
               'Total_N': '0.570±0.063',
               'available_P': '0.753±0.028',
               'pH_dry_soil': '0.713±0.019'},
       'MT': {'EC_electric_conductivity': '0.745±0.023',
              'Total_C': '0.781±0.030',
              'Total_N': '0.626±0.084',
              'available_P': '0.772±0.019',
              'pH_dry_soil': '0.685±0.021'},
       'MT_SUM': {'EC_electric_conductivity': '0.749±0.022',
                  'Total_C': '0.782±0.013',
                  'Total_N': '0.629±0.071',
                  'available_P': '0.771±0.030',
                  'pH_dry_soil': '0.678±0.015'},
       'RF': {'EC_electric_conductivity': '0.728±0.034',
              'Total_C': '0.747±0.031',
              'Total_N': '0.500±0.100',
              'available_P': '0.741±0.037',
              'pH_dry_soil': '0.734±0.020'},
       'ST': {'EC_electric_conductivity': '0.763±0.017',
              'Total_C': '0.790±0.023',
              'Total_N': '0.622±0.058',
              'available_P': '0.792±0.022',
              'pH_dry_soil': '0.682±0.018'},
       'XGB': {'EC_electric_conductivity': '0.686±0.036',
               'Total_C': '0.748±0.011',
               'Total_N': '0.570±0.074',
               'available_P': '0.725±0.032',
               'pH_dry_soil': '0.699±0.009'}}}
CSVファイル 'result.csv' を作成しました。
